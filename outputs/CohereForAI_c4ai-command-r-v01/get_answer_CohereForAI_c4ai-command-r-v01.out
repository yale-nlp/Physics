INFO 01-28 01:03:12 __init__.py:183] Automatically detected platform cuda.
INFO 01-28 01:03:18 config.py:520] This model supports multiple tasks: {'classify', 'score', 'embed', 'generate', 'reward'}. Defaulting to 'generate'.
INFO 01-28 01:03:18 config.py:1328] Defaulting to use mp for distributed inference
INFO 01-28 01:03:18 llm_engine.py:232] Initializing an LLM engine (v0.7.0) with config: model='CohereForAI/c4ai-command-r-v01', speculative_config=None, tokenizer='CohereForAI/c4ai-command-r-v01', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.float16, max_seq_len=2048, download_dir='scratch/kaiyue_hf_cache', load_format=LoadFormat.AUTO, tensor_parallel_size=2, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto,  device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=CohereForAI/c4ai-command-r-v01, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":[],"compile_sizes":[],"cudagraph_capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
WARNING 01-28 01:03:20 multiproc_worker_utils.py:298] Reducing Torch parallelism from 2 threads to 1 to avoid unnecessary CPU contention. Set OMP_NUM_THREADS in the external environment to tune this value as needed.
INFO 01-28 01:03:20 custom_cache_manager.py:17] Setting Triton cache manager to: vllm.triton_utils.custom_cache_manager:CustomCacheManager
[1;36m(VllmWorkerProcess pid=3043895)[0;0m INFO 01-28 01:03:20 multiproc_worker_utils.py:227] Worker ready; awaiting tasks
INFO 01-28 01:03:21 cuda.py:225] Using Flash Attention backend.
[1;36m(VllmWorkerProcess pid=3043895)[0;0m INFO 01-28 01:03:21 cuda.py:225] Using Flash Attention backend.
INFO 01-28 01:03:22 utils.py:938] Found nccl from library libnccl.so.2
[1;36m(VllmWorkerProcess pid=3043895)[0;0m INFO 01-28 01:03:22 utils.py:938] Found nccl from library libnccl.so.2
INFO 01-28 01:03:22 pynccl.py:67] vLLM is using nccl==2.21.5
[1;36m(VllmWorkerProcess pid=3043895)[0;0m INFO 01-28 01:03:22 pynccl.py:67] vLLM is using nccl==2.21.5
[1;36m(VllmWorkerProcess pid=3043895)[0;0m INFO 01-28 01:03:22 custom_all_reduce_utils.py:242] reading GPU P2P access cache from /gpfs/radev/home/lx228/.cache/vllm/gpu_p2p_access_cache_for_0,1.json
INFO 01-28 01:03:22 custom_all_reduce_utils.py:242] reading GPU P2P access cache from /gpfs/radev/home/lx228/.cache/vllm/gpu_p2p_access_cache_for_0,1.json
INFO 01-28 01:03:22 shm_broadcast.py:256] vLLM message queue communication handle: Handle(connect_ip='127.0.0.1', local_reader_ranks=[1], buffer_handle=(1, 4194304, 6, 'psm_f979a93d'), local_subscribe_port=36881, remote_subscribe_port=None)
INFO 01-28 01:03:22 model_runner.py:1110] Starting to load model CohereForAI/c4ai-command-r-v01...
[1;36m(VllmWorkerProcess pid=3043895)[0;0m INFO 01-28 01:03:22 model_runner.py:1110] Starting to load model CohereForAI/c4ai-command-r-v01...
INFO 01-28 01:03:22 weight_utils.py:251] Using model weights format ['*.safetensors']
[1;36m(VllmWorkerProcess pid=3043895)[0;0m INFO 01-28 01:03:22 weight_utils.py:251] Using model weights format ['*.safetensors']
Loading safetensors checkpoint shards:   0% Completed | 0/15 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:   7% Completed | 1/15 [00:03<00:53,  3.79s/it]
Loading safetensors checkpoint shards:  13% Completed | 2/15 [00:04<00:27,  2.09s/it]
Loading safetensors checkpoint shards:  20% Completed | 3/15 [00:08<00:35,  2.93s/it]
Loading safetensors checkpoint shards:  27% Completed | 4/15 [00:12<00:36,  3.31s/it]
Loading safetensors checkpoint shards:  33% Completed | 5/15 [00:17<00:38,  3.81s/it]
Loading safetensors checkpoint shards:  40% Completed | 6/15 [00:22<00:37,  4.20s/it]
Loading safetensors checkpoint shards:  47% Completed | 7/15 [00:27<00:35,  4.44s/it]
Loading safetensors checkpoint shards:  53% Completed | 8/15 [00:32<00:32,  4.60s/it]
Loading safetensors checkpoint shards:  60% Completed | 9/15 [00:36<00:28,  4.67s/it]
Loading safetensors checkpoint shards:  67% Completed | 10/15 [00:41<00:23,  4.73s/it]
Loading safetensors checkpoint shards:  73% Completed | 11/15 [00:46<00:19,  4.78s/it]
Loading safetensors checkpoint shards:  80% Completed | 12/15 [00:51<00:14,  4.80s/it]
Loading safetensors checkpoint shards:  87% Completed | 13/15 [00:56<00:09,  4.84s/it]
Loading safetensors checkpoint shards:  93% Completed | 14/15 [01:01<00:04,  4.88s/it]
Loading safetensors checkpoint shards: 100% Completed | 15/15 [01:05<00:00,  4.74s/it]
Loading safetensors checkpoint shards: 100% Completed | 15/15 [01:05<00:00,  4.39s/it]

INFO 01-28 01:08:23 model_runner.py:1115] Loading model weights took 32.6101 GB
[1;36m(VllmWorkerProcess pid=3043895)[0;0m INFO 01-28 01:08:23 model_runner.py:1115] Loading model weights took 32.6101 GB
[1;36m(VllmWorkerProcess pid=3043895)[0;0m INFO 01-28 01:08:27 worker.py:266] Memory profiling takes 3.33 seconds
[1;36m(VllmWorkerProcess pid=3043895)[0;0m INFO 01-28 01:08:27 worker.py:266] the current vLLM instance can use total_gpu_memory (79.14GiB) x gpu_memory_utilization (0.90) = 71.22GiB
[1;36m(VllmWorkerProcess pid=3043895)[0;0m INFO 01-28 01:08:27 worker.py:266] model weights take 32.61GiB; non_torch_memory takes 0.30GiB; PyTorch activation peak memory takes 0.32GiB; the rest of the memory reserved for KV Cache is 37.99GiB.
INFO 01-28 01:08:27 worker.py:266] Memory profiling takes 3.68 seconds
INFO 01-28 01:08:27 worker.py:266] the current vLLM instance can use total_gpu_memory (79.14GiB) x gpu_memory_utilization (0.90) = 71.22GiB
INFO 01-28 01:08:27 worker.py:266] model weights take 32.61GiB; non_torch_memory takes 0.30GiB; PyTorch activation peak memory takes 2.36GiB; the rest of the memory reserved for KV Cache is 35.96GiB.
INFO 01-28 01:08:27 executor_base.py:108] # CUDA blocks: 3681, # CPU blocks: 409
INFO 01-28 01:08:27 executor_base.py:113] Maximum concurrency for 2048 tokens per request: 28.76x
INFO 01-28 01:08:31 model_runner.py:1430] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
[1;36m(VllmWorkerProcess pid=3043895)[0;0m INFO 01-28 01:08:31 model_runner.py:1430] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:25,  1.32it/s]Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:01<00:18,  1.79it/s]Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:01<00:15,  2.02it/s]Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:02<00:14,  2.15it/s]Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:02<00:13,  2.21it/s]Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:02<00:12,  2.27it/s]Capturing CUDA graph shapes:  20%|██        | 7/35 [00:03<00:12,  2.26it/s]Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:03<00:11,  2.31it/s]Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:04<00:11,  2.35it/s]Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:04<00:10,  2.38it/s]Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:04<00:09,  2.40it/s]Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:05<00:09,  2.41it/s]Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:05<00:09,  2.43it/s]Capturing CUDA graph shapes:  40%|████      | 14/35 [00:06<00:08,  2.43it/s]Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:06<00:08,  2.42it/s]Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:06<00:07,  2.43it/s]Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:07<00:07,  2.48it/s]Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:07<00:06,  2.52it/s]Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:08<00:06,  2.55it/s]Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:08<00:05,  2.57it/s]Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:08<00:05,  2.59it/s]Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:09<00:04,  2.60it/s]Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:09<00:04,  2.61it/s]Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:10<00:04,  2.62it/s]Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:10<00:03,  2.64it/s]Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:10<00:03,  2.65it/s]Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:11<00:03,  2.65it/s]Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:11<00:02,  2.66it/s]Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:11<00:02,  2.67it/s]Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:12<00:01,  2.68it/s]Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:12<00:01,  2.67it/s]Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:13<00:01,  2.68it/s]Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:13<00:00,  2.68it/s]Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:13<00:00,  2.69it/s][1;36m(VllmWorkerProcess pid=3043895)[0;0m INFO 01-28 01:08:46 custom_all_reduce.py:224] Registering 2835 cuda graph addresses
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:14<00:00,  1.84it/s]Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:14<00:00,  2.38it/s]
INFO 01-28 01:08:46 custom_all_reduce.py:224] Registering 2835 cuda graph addresses
[1;36m(VllmWorkerProcess pid=3043895)[0;0m INFO 01-28 01:08:46 model_runner.py:1558] Graph capturing finished in 15 secs, took 0.27 GiB
INFO 01-28 01:08:46 model_runner.py:1558] Graph capturing finished in 15 secs, took 0.27 GiB
INFO 01-28 01:08:46 llm_engine.py:429] init engine (profile, create kv cache, warmup model) took 22.82 seconds
vLLM engine initialized.
Processing dataset: project/Kaiyue/datasets/atomic_dataset_textonly.jsonl
Processing atomic_dataset_textonly:   0%|          | 0/187 [00:00<?, ?it/s]Processing atomic_dataset_textonly: 100%|██████████| 187/187 [00:00<00:00, 935960.44it/s]
INFO 01-28 01:08:46 chat_utils.py:330] Detected the chat template content format to be 'string'. You can set `--chat-template-content-format` to override this.
Processed prompts:   0%|          | 0/187 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]WARNING 01-28 01:09:08 scheduler.py:1558] Sequence group 186 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=1
Processed prompts:   1%|          | 1/187 [00:23<1:12:17, 23.32s/it, est. speed input: 4.42 toks/s, output: 6.00 toks/s]Processed prompts:   1%|          | 2/187 [00:27<36:47, 11.93s/it, est. speed input: 6.56 toks/s, output: 11.58 toks/s] Processed prompts:   2%|▏         | 3/187 [00:27<20:27,  6.67s/it, est. speed input: 10.25 toks/s, output: 17.91 toks/s]Processed prompts:   2%|▏         | 4/187 [00:28<13:47,  4.52s/it, est. speed input: 12.69 toks/s, output: 23.79 toks/s]Processed prompts:   3%|▎         | 5/187 [00:29<09:12,  3.04s/it, est. speed input: 15.59 toks/s, output: 30.15 toks/s]Processed prompts:   3%|▎         | 6/187 [00:31<07:59,  2.65s/it, est. speed input: 18.42 toks/s, output: 35.21 toks/s]Processed prompts:   4%|▎         | 7/187 [00:31<05:38,  1.88s/it, est. speed input: 21.52 toks/s, output: 41.79 toks/s]Processed prompts:   4%|▍         | 8/187 [00:31<04:11,  1.41s/it, est. speed input: 25.04 toks/s, output: 48.24 toks/s]Processed prompts:   5%|▍         | 9/187 [00:32<03:13,  1.09s/it, est. speed input: 27.77 toks/s, output: 54.65 toks/s]Processed prompts:   6%|▌         | 11/187 [00:36<04:43,  1.61s/it, est. speed input: 30.07 toks/s, output: 61.72 toks/s]Processed prompts:   6%|▋         | 12/187 [00:37<03:44,  1.29s/it, est. speed input: 32.78 toks/s, output: 68.64 toks/s]WARNING 01-28 01:09:23 scheduler.py:1558] Sequence group 133 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=51
Processed prompts:   7%|▋         | 13/187 [00:37<03:03,  1.05s/it, est. speed input: 35.18 toks/s, output: 75.40 toks/s]Processed prompts:   7%|▋         | 14/187 [00:37<02:23,  1.20it/s, est. speed input: 37.76 toks/s, output: 82.46 toks/s]Processed prompts:   8%|▊         | 15/187 [00:38<02:02,  1.41it/s, est. speed input: 39.73 toks/s, output: 89.18 toks/s]Processed prompts:   9%|▊         | 16/187 [00:38<01:50,  1.55it/s, est. speed input: 41.88 toks/s, output: 95.72 toks/s]Processed prompts:   9%|▉         | 17/187 [00:38<01:25,  1.99it/s, est. speed input: 44.55 toks/s, output: 103.00 toks/s]Processed prompts:  10%|▉         | 18/187 [00:39<01:19,  2.12it/s, est. speed input: 46.81 toks/s, output: 109.68 toks/s]Processed prompts:  11%|█         | 20/187 [00:40<01:20,  2.07it/s, est. speed input: 51.11 toks/s, output: 122.30 toks/s]Processed prompts:  11%|█         | 21/187 [00:40<01:16,  2.17it/s, est. speed input: 54.86 toks/s, output: 128.97 toks/s]Processed prompts:  12%|█▏        | 22/187 [00:40<01:09,  2.36it/s, est. speed input: 57.14 toks/s, output: 135.86 toks/s]Processed prompts:  12%|█▏        | 23/187 [00:41<01:35,  1.72it/s, est. speed input: 57.89 toks/s, output: 140.60 toks/s]Processed prompts:  13%|█▎        | 24/187 [00:42<01:18,  2.07it/s, est. speed input: 60.33 toks/s, output: 147.87 toks/s]Processed prompts:  13%|█▎        | 25/187 [00:42<01:06,  2.43it/s, est. speed input: 62.20 toks/s, output: 155.13 toks/s]Processed prompts:  14%|█▍        | 26/187 [00:43<01:26,  1.86it/s, est. speed input: 63.18 toks/s, output: 160.25 toks/s]Processed prompts:  14%|█▍        | 27/187 [00:43<01:15,  2.13it/s, est. speed input: 66.37 toks/s, output: 167.32 toks/s]Processed prompts:  15%|█▍        | 28/187 [00:43<01:17,  2.05it/s, est. speed input: 67.55 toks/s, output: 173.56 toks/s]Processed prompts:  16%|█▌        | 30/187 [00:44<01:00,  2.61it/s, est. speed input: 72.06 toks/s, output: 187.99 toks/s]Processed prompts:  17%|█▋        | 31/187 [00:45<01:08,  2.29it/s, est. speed input: 73.82 toks/s, output: 193.81 toks/s]Processed prompts:  17%|█▋        | 32/187 [00:47<02:08,  1.20it/s, est. speed input: 72.12 toks/s, output: 194.32 toks/s]Processed prompts:  18%|█▊        | 33/187 [00:47<01:45,  1.46it/s, est. speed input: 74.42 toks/s, output: 201.69 toks/s]Processed prompts:  19%|█▊        | 35/187 [00:47<01:17,  1.97it/s, est. speed input: 78.10 toks/s, output: 216.43 toks/s]Processed prompts:  19%|█▉        | 36/187 [00:48<01:11,  2.11it/s, est. speed input: 80.43 toks/s, output: 223.40 toks/s]Processed prompts:  20%|██        | 38/187 [00:49<01:21,  1.84it/s, est. speed input: 82.94 toks/s, output: 234.68 toks/s]Processed prompts:  21%|██        | 39/187 [00:49<01:17,  1.92it/s, est. speed input: 86.27 toks/s, output: 241.35 toks/s]Processed prompts:  21%|██▏       | 40/187 [00:51<01:44,  1.40it/s, est. speed input: 86.57 toks/s, output: 244.04 toks/s]Processed prompts:  22%|██▏       | 41/187 [00:51<01:22,  1.76it/s, est. speed input: 88.45 toks/s, output: 252.24 toks/s]Processed prompts:  22%|██▏       | 42/187 [00:54<02:44,  1.14s/it, est. speed input: 85.70 toks/s, output: 248.79 toks/s]Processed prompts:  23%|██▎       | 43/187 [00:54<02:04,  1.16it/s, est. speed input: 88.95 toks/s, output: 257.24 toks/s]Processed prompts:  24%|██▎       | 44/187 [00:54<01:49,  1.31it/s, est. speed input: 91.67 toks/s, output: 263.89 toks/s]Processed prompts:  24%|██▍       | 45/187 [00:56<02:09,  1.09it/s, est. speed input: 91.45 toks/s, output: 267.07 toks/s]Processed prompts:  25%|██▍       | 46/187 [00:57<02:37,  1.12s/it, est. speed input: 94.22 toks/s, output: 268.92 toks/s]Processed prompts:  25%|██▌       | 47/187 [00:58<02:05,  1.12it/s, est. speed input: 95.62 toks/s, output: 276.66 toks/s]Processed prompts:  26%|██▌       | 48/187 [00:58<01:41,  1.37it/s, est. speed input: 98.30 toks/s, output: 284.41 toks/s]Processed prompts:  26%|██▌       | 49/187 [00:58<01:29,  1.55it/s, est. speed input: 100.00 toks/s, output: 291.65 toks/s]Processed prompts:  27%|██▋       | 50/187 [01:00<02:02,  1.12it/s, est. speed input: 102.79 toks/s, output: 294.04 toks/s]Processed prompts:  27%|██▋       | 51/187 [01:00<01:47,  1.26it/s, est. speed input: 104.00 toks/s, output: 300.90 toks/s]Processed prompts:  28%|██▊       | 52/187 [01:02<02:12,  1.02it/s, est. speed input: 103.26 toks/s, output: 303.65 toks/s]Processed prompts:  28%|██▊       | 53/187 [01:03<02:02,  1.10it/s, est. speed input: 105.52 toks/s, output: 309.66 toks/s]Processed prompts:  29%|██▉       | 55/187 [01:03<01:20,  1.64it/s, est. speed input: 108.05 toks/s, output: 326.41 toks/s]Processed prompts:  30%|██▉       | 56/187 [01:04<01:20,  1.64it/s, est. speed input: 110.23 toks/s, output: 332.98 toks/s]Processed prompts:  30%|███       | 57/187 [01:05<01:41,  1.28it/s, est. speed input: 111.05 toks/s, output: 336.28 toks/s]Processed prompts:  31%|███       | 58/187 [01:05<01:20,  1.60it/s, est. speed input: 112.13 toks/s, output: 344.98 toks/s]Processed prompts:  32%|███▏      | 59/187 [01:05<01:10,  1.80it/s, est. speed input: 113.30 toks/s, output: 352.76 toks/s]Processed prompts:  33%|███▎      | 61/187 [01:06<00:55,  2.27it/s, est. speed input: 120.42 toks/s, output: 368.92 toks/s]Processed prompts:  33%|███▎      | 62/187 [01:07<01:16,  1.63it/s, est. speed input: 121.18 toks/s, output: 372.35 toks/s]Processed prompts:  34%|███▎      | 63/187 [01:08<01:13,  1.68it/s, est. speed input: 122.26 toks/s, output: 379.12 toks/s]Processed prompts:  35%|███▍      | 65/187 [01:08<00:57,  2.13it/s, est. speed input: 124.27 toks/s, output: 395.24 toks/s]Processed prompts:  35%|███▌      | 66/187 [01:09<00:51,  2.35it/s, est. speed input: 125.84 toks/s, output: 403.38 toks/s]Processed prompts:  36%|███▌      | 67/187 [01:09<00:58,  2.05it/s, est. speed input: 126.17 toks/s, output: 409.21 toks/s]Processed prompts:  36%|███▋      | 68/187 [01:10<00:49,  2.42it/s, est. speed input: 127.29 toks/s, output: 417.75 toks/s]Processed prompts:  37%|███▋      | 69/187 [01:10<00:41,  2.87it/s, est. speed input: 130.60 toks/s, output: 426.43 toks/s]Processed prompts:  37%|███▋      | 70/187 [01:11<00:55,  2.10it/s, est. speed input: 133.59 toks/s, output: 431.28 toks/s]Processed prompts:  38%|███▊      | 71/187 [01:11<00:58,  1.97it/s, est. speed input: 135.75 toks/s, output: 437.47 toks/s]Processed prompts:  39%|███▊      | 72/187 [01:11<00:45,  2.51it/s, est. speed input: 137.22 toks/s, output: 446.40 toks/s]Processed prompts:  39%|███▉      | 73/187 [01:12<00:52,  2.17it/s, est. speed input: 137.66 toks/s, output: 452.33 toks/s]Processed prompts:  40%|████      | 75/187 [01:12<00:38,  2.92it/s, est. speed input: 139.49 toks/s, output: 463.88 toks/s]Processed prompts:  41%|████      | 76/187 [01:12<00:34,  3.19it/s, est. speed input: 141.23 toks/s, output: 472.11 toks/s]Processed prompts:  41%|████      | 77/187 [01:13<00:37,  2.90it/s, est. speed input: 143.60 toks/s, output: 478.94 toks/s]Processed prompts:  42%|████▏     | 78/187 [01:14<00:57,  1.89it/s, est. speed input: 145.98 toks/s, output: 482.00 toks/s]Processed prompts:  42%|████▏     | 79/187 [01:14<00:49,  2.18it/s, est. speed input: 148.20 toks/s, output: 489.91 toks/s]Processed prompts:  43%|████▎     | 80/187 [01:16<01:19,  1.34it/s, est. speed input: 146.82 toks/s, output: 490.17 toks/s]Processed prompts:  44%|████▍     | 82/187 [01:16<00:50,  2.09it/s, est. speed input: 151.67 toks/s, output: 503.06 toks/s]Processed prompts:  44%|████▍     | 83/187 [01:16<00:49,  2.10it/s, est. speed input: 152.22 toks/s, output: 507.57 toks/s]Processed prompts:  45%|████▍     | 84/187 [01:17<00:42,  2.42it/s, est. speed input: 154.96 toks/s, output: 515.70 toks/s]Processed prompts:  45%|████▌     | 85/187 [01:17<00:45,  2.24it/s, est. speed input: 155.09 toks/s, output: 521.74 toks/s]Processed prompts:  47%|████▋     | 87/187 [01:18<00:36,  2.71it/s, est. speed input: 160.07 toks/s, output: 537.36 toks/s]Processed prompts:  47%|████▋     | 88/187 [01:19<00:48,  2.05it/s, est. speed input: 159.92 toks/s, output: 541.03 toks/s]Processed prompts:  48%|████▊     | 89/187 [01:19<00:46,  2.10it/s, est. speed input: 161.95 toks/s, output: 547.62 toks/s]Processed prompts:  48%|████▊     | 90/187 [01:21<01:16,  1.26it/s, est. speed input: 160.84 toks/s, output: 546.04 toks/s]Processed prompts:  49%|████▊     | 91/187 [01:21<01:05,  1.47it/s, est. speed input: 161.72 toks/s, output: 553.20 toks/s]Processed prompts:  50%|████▉     | 93/187 [01:22<00:51,  1.84it/s, est. speed input: 162.78 toks/s, output: 565.42 toks/s]Processed prompts:  50%|█████     | 94/187 [01:23<00:53,  1.75it/s, est. speed input: 163.88 toks/s, output: 570.58 toks/s]Processed prompts:  51%|█████     | 95/187 [01:23<00:49,  1.85it/s, est. speed input: 164.81 toks/s, output: 577.20 toks/s]Processed prompts:  51%|█████▏    | 96/187 [01:24<01:00,  1.50it/s, est. speed input: 166.70 toks/s, output: 580.02 toks/s]Processed prompts:  52%|█████▏    | 97/187 [01:25<00:56,  1.60it/s, est. speed input: 167.35 toks/s, output: 584.05 toks/s]Processed prompts:  52%|█████▏    | 98/187 [01:25<00:58,  1.52it/s, est. speed input: 169.11 toks/s, output: 588.69 toks/s]Processed prompts:  53%|█████▎    | 99/187 [01:26<00:56,  1.55it/s, est. speed input: 171.88 toks/s, output: 594.20 toks/s]Processed prompts:  53%|█████▎    | 100/187 [01:26<00:46,  1.87it/s, est. speed input: 172.29 toks/s, output: 601.99 toks/s]Processed prompts:  54%|█████▍    | 101/187 [01:27<00:54,  1.58it/s, est. speed input: 171.95 toks/s, output: 605.74 toks/s]Processed prompts:  55%|█████▍    | 102/187 [01:28<00:51,  1.66it/s, est. speed input: 171.91 toks/s, output: 606.77 toks/s]Processed prompts:  55%|█████▌    | 103/187 [01:28<00:40,  2.06it/s, est. speed input: 173.36 toks/s, output: 610.47 toks/s]Processed prompts:  56%|█████▌    | 104/187 [01:29<00:51,  1.61it/s, est. speed input: 174.40 toks/s, output: 611.40 toks/s]Processed prompts:  56%|█████▌    | 105/187 [01:29<00:53,  1.52it/s, est. speed input: 177.04 toks/s, output: 616.15 toks/s]Processed prompts:  57%|█████▋    | 106/187 [01:30<00:57,  1.40it/s, est. speed input: 177.44 toks/s, output: 620.22 toks/s]Processed prompts:  57%|█████▋    | 107/187 [01:32<01:16,  1.05it/s, est. speed input: 175.54 toks/s, output: 613.47 toks/s]Processed prompts:  58%|█████▊    | 108/187 [01:32<00:56,  1.41it/s, est. speed input: 180.11 toks/s, output: 622.37 toks/s]Processed prompts:  58%|█████▊    | 109/187 [01:33<00:56,  1.39it/s, est. speed input: 179.97 toks/s, output: 627.23 toks/s]Processed prompts:  59%|█████▉    | 110/187 [01:33<00:56,  1.36it/s, est. speed input: 179.61 toks/s, output: 625.43 toks/s]Processed prompts:  59%|█████▉    | 111/187 [01:34<00:50,  1.51it/s, est. speed input: 180.03 toks/s, output: 632.02 toks/s]Processed prompts:  60%|█████▉    | 112/187 [01:34<00:40,  1.87it/s, est. speed input: 181.10 toks/s, output: 640.32 toks/s]Processed prompts:  60%|██████    | 113/187 [01:35<00:42,  1.75it/s, est. speed input: 182.47 toks/s, output: 645.75 toks/s]Processed prompts:  61%|██████    | 114/187 [01:36<00:50,  1.44it/s, est. speed input: 182.31 toks/s, output: 646.18 toks/s]Processed prompts:  61%|██████▏   | 115/187 [01:36<00:39,  1.82it/s, est. speed input: 185.82 toks/s, output: 654.70 toks/s]Processed prompts:  63%|██████▎   | 117/187 [01:36<00:26,  2.67it/s, est. speed input: 188.48 toks/s, output: 667.58 toks/s]Processed prompts:  63%|██████▎   | 118/187 [01:37<00:25,  2.74it/s, est. speed input: 189.91 toks/s, output: 675.22 toks/s]Processed prompts:  64%|██████▎   | 119/187 [01:37<00:32,  2.08it/s, est. speed input: 190.17 toks/s, output: 674.91 toks/s]Processed prompts:  64%|██████▍   | 120/187 [01:38<00:25,  2.59it/s, est. speed input: 190.91 toks/s, output: 680.21 toks/s]Processed prompts:  65%|██████▌   | 122/187 [01:39<00:27,  2.38it/s, est. speed input: 191.42 toks/s, output: 685.10 toks/s]Processed prompts:  66%|██████▌   | 123/187 [01:39<00:32,  1.96it/s, est. speed input: 191.17 toks/s, output: 689.74 toks/s]Processed prompts:  66%|██████▋   | 124/187 [01:40<00:27,  2.25it/s, est. speed input: 192.24 toks/s, output: 698.11 toks/s]Processed prompts:  67%|██████▋   | 125/187 [01:40<00:22,  2.78it/s, est. speed input: 195.14 toks/s, output: 700.47 toks/s]Processed prompts:  67%|██████▋   | 126/187 [01:40<00:27,  2.23it/s, est. speed input: 196.06 toks/s, output: 699.92 toks/s]Processed prompts:  68%|██████▊   | 127/187 [01:41<00:23,  2.55it/s, est. speed input: 196.58 toks/s, output: 702.00 toks/s]Processed prompts:  69%|██████▉   | 129/187 [01:41<00:19,  2.94it/s, est. speed input: 202.37 toks/s, output: 713.42 toks/s]Processed prompts:  70%|██████▉   | 130/187 [01:42<00:20,  2.77it/s, est. speed input: 202.75 toks/s, output: 720.68 toks/s]Processed prompts:  70%|███████   | 131/187 [01:42<00:23,  2.36it/s, est. speed input: 202.36 toks/s, output: 722.47 toks/s]Processed prompts:  71%|███████   | 132/187 [01:43<00:25,  2.13it/s, est. speed input: 202.74 toks/s, output: 723.39 toks/s]Processed prompts:  71%|███████   | 133/187 [01:43<00:20,  2.58it/s, est. speed input: 203.64 toks/s, output: 732.47 toks/s]Processed prompts:  72%|███████▏  | 134/187 [01:44<00:33,  1.59it/s, est. speed input: 204.03 toks/s, output: 734.23 toks/s]Processed prompts:  72%|███████▏  | 135/187 [01:45<00:41,  1.25it/s, est. speed input: 202.52 toks/s, output: 729.78 toks/s]Processed prompts:  73%|███████▎  | 136/187 [01:46<00:36,  1.38it/s, est. speed input: 203.18 toks/s, output: 730.16 toks/s]Processed prompts:  73%|███████▎  | 137/187 [01:46<00:30,  1.63it/s, est. speed input: 205.71 toks/s, output: 737.12 toks/s]Processed prompts:  74%|███████▍  | 138/187 [01:47<00:36,  1.35it/s, est. speed input: 204.97 toks/s, output: 740.58 toks/s]Processed prompts:  74%|███████▍  | 139/187 [01:48<00:26,  1.80it/s, est. speed input: 205.68 toks/s, output: 744.48 toks/s]Processed prompts:  75%|███████▍  | 140/187 [01:48<00:29,  1.59it/s, est. speed input: 207.66 toks/s, output: 745.69 toks/s]Processed prompts:  75%|███████▌  | 141/187 [01:48<00:21,  2.11it/s, est. speed input: 208.93 toks/s, output: 755.58 toks/s]Processed prompts:  76%|███████▌  | 142/187 [01:49<00:16,  2.74it/s, est. speed input: 209.92 toks/s, output: 758.12 toks/s]Processed prompts:  76%|███████▋  | 143/187 [01:49<00:16,  2.69it/s, est. speed input: 211.84 toks/s, output: 766.13 toks/s]Processed prompts:  78%|███████▊  | 145/187 [01:49<00:11,  3.63it/s, est. speed input: 214.03 toks/s, output: 780.36 toks/s]Processed prompts:  78%|███████▊  | 146/187 [01:51<00:22,  1.85it/s, est. speed input: 214.27 toks/s, output: 776.90 toks/s]Processed prompts:  79%|███████▊  | 147/187 [01:51<00:19,  2.01it/s, est. speed input: 214.62 toks/s, output: 779.37 toks/s]Processed prompts:  79%|███████▉  | 148/187 [01:51<00:16,  2.31it/s, est. speed input: 216.31 toks/s, output: 783.67 toks/s]Processed prompts:  80%|███████▉  | 149/187 [01:52<00:16,  2.25it/s, est. speed input: 216.85 toks/s, output: 786.48 toks/s]Processed prompts:  80%|████████  | 150/187 [01:52<00:15,  2.38it/s, est. speed input: 217.13 toks/s, output: 787.90 toks/s]Processed prompts:  81%|████████  | 151/187 [01:54<00:28,  1.26it/s, est. speed input: 215.21 toks/s, output: 783.19 toks/s]Processed prompts:  81%|████████▏ | 152/187 [01:55<00:29,  1.20it/s, est. speed input: 215.39 toks/s, output: 787.97 toks/s]Processed prompts:  82%|████████▏ | 153/187 [01:56<00:29,  1.16it/s, est. speed input: 215.11 toks/s, output: 788.95 toks/s]Processed prompts:  82%|████████▏ | 154/187 [01:57<00:35,  1.09s/it, est. speed input: 212.95 toks/s, output: 783.95 toks/s]Processed prompts:  83%|████████▎ | 155/187 [01:58<00:32,  1.02s/it, est. speed input: 214.78 toks/s, output: 789.58 toks/s]Processed prompts:  83%|████████▎ | 156/187 [01:59<00:29,  1.06it/s, est. speed input: 215.11 toks/s, output: 790.50 toks/s]Processed prompts:  84%|████████▍ | 157/187 [02:00<00:29,  1.03it/s, est. speed input: 214.28 toks/s, output: 795.20 toks/s]Processed prompts:  84%|████████▍ | 158/187 [02:01<00:31,  1.09s/it, est. speed input: 212.95 toks/s, output: 793.76 toks/s]Processed prompts:  85%|████████▌ | 159/187 [02:02<00:25,  1.10it/s, est. speed input: 213.33 toks/s, output: 797.59 toks/s]Processed prompts:  86%|████████▌ | 160/187 [02:02<00:21,  1.28it/s, est. speed input: 215.48 toks/s, output: 803.37 toks/s]Processed prompts:  86%|████████▌ | 161/187 [02:02<00:16,  1.62it/s, est. speed input: 217.65 toks/s, output: 813.49 toks/s]Processed prompts:  87%|████████▋ | 163/187 [02:03<00:09,  2.46it/s, est. speed input: 220.43 toks/s, output: 825.20 toks/s]Processed prompts:  88%|████████▊ | 164/187 [02:03<00:07,  2.95it/s, est. speed input: 221.38 toks/s, output: 832.55 toks/s]Processed prompts:  88%|████████▊ | 165/187 [02:03<00:06,  3.36it/s, est. speed input: 222.67 toks/s, output: 838.56 toks/s]Processed prompts:  89%|████████▉ | 166/187 [02:04<00:10,  2.04it/s, est. speed input: 222.87 toks/s, output: 838.16 toks/s]Processed prompts:  90%|████████▉ | 168/187 [02:05<00:07,  2.57it/s, est. speed input: 228.08 toks/s, output: 851.91 toks/s]Processed prompts:  90%|█████████ | 169/187 [02:05<00:06,  2.88it/s, est. speed input: 228.57 toks/s, output: 857.06 toks/s]Processed prompts:  91%|█████████ | 170/187 [02:06<00:09,  1.77it/s, est. speed input: 227.32 toks/s, output: 854.67 toks/s]Processed prompts:  91%|█████████▏| 171/187 [02:07<00:09,  1.75it/s, est. speed input: 227.18 toks/s, output: 856.73 toks/s]Processed prompts:  92%|█████████▏| 172/187 [02:07<00:08,  1.79it/s, est. speed input: 228.66 toks/s, output: 860.96 toks/s]Processed prompts:  93%|█████████▎| 174/187 [02:08<00:06,  1.98it/s, est. speed input: 229.68 toks/s, output: 870.12 toks/s]Processed prompts:  94%|█████████▍| 176/187 [02:11<00:09,  1.12it/s, est. speed input: 227.81 toks/s, output: 869.14 toks/s]Processed prompts:  95%|█████████▍| 177/187 [02:12<00:09,  1.01it/s, est. speed input: 228.30 toks/s, output: 873.10 toks/s]Processed prompts:  95%|█████████▌| 178/187 [02:14<00:09,  1.11s/it, est. speed input: 228.19 toks/s, output: 876.21 toks/s]Processed prompts:  96%|█████████▌| 179/187 [02:15<00:09,  1.20s/it, est. speed input: 227.82 toks/s, output: 874.69 toks/s]Processed prompts:  96%|█████████▋| 180/187 [02:16<00:07,  1.05s/it, est. speed input: 228.34 toks/s, output: 878.49 toks/s]Processed prompts:  97%|█████████▋| 181/187 [02:18<00:07,  1.23s/it, est. speed input: 228.14 toks/s, output: 876.82 toks/s]Processed prompts:  97%|█████████▋| 182/187 [02:19<00:06,  1.34s/it, est. speed input: 227.37 toks/s, output: 878.13 toks/s]Processed prompts:  98%|█████████▊| 183/187 [02:21<00:05,  1.39s/it, est. speed input: 228.26 toks/s, output: 878.77 toks/s]Processed prompts:  98%|█████████▊| 184/187 [02:24<00:06,  2.01s/it, est. speed input: 228.12 toks/s, output: 866.35 toks/s]Processed prompts:  99%|█████████▉| 185/187 [02:26<00:03,  1.77s/it, est. speed input: 228.19 toks/s, output: 869.00 toks/s]Processed prompts:  99%|█████████▉| 186/187 [02:26<00:01,  1.40s/it, est. speed input: 229.49 toks/s, output: 877.77 toks/s]Processed prompts: 100%|██████████| 187/187 [02:33<00:00,  3.09s/it, est. speed input: 219.93 toks/s, output: 849.44 toks/s]Processed prompts: 100%|██████████| 187/187 [02:33<00:00,  1.22it/s, est. speed input: 219.93 toks/s, output: 849.44 toks/s]
Results for dataset atomic_dataset_textonly saved to project/Kaiyue/offline_outputs/CohereForAI_c4ai-command-r-v01/atomic_dataset_textonly/response.jsonl.
Processing dataset: project/Kaiyue/datasets/electro_dataset_textonly.jsonl
Processing electro_dataset_textonly:   0%|          | 0/170 [00:00<?, ?it/s]Processing electro_dataset_textonly: 100%|██████████| 170/170 [00:00<00:00, 387938.89it/s]
Processed prompts:   0%|          | 0/170 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   1%|          | 1/170 [00:19<56:04, 19.91s/it, est. speed input: 7.33 toks/s, output: 5.78 toks/s]Processed prompts:   1%|          | 2/170 [00:23<28:29, 10.18s/it, est. speed input: 10.40 toks/s, output: 11.26 toks/s]WARNING 01-28 01:11:49 scheduler.py:1558] Sequence group 336 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=101
Processed prompts:   2%|▏         | 3/170 [00:31<25:55,  9.31s/it, est. speed input: 10.93 toks/s, output: 15.43 toks/s]Processed prompts:   2%|▏         | 4/170 [00:34<18:29,  6.69s/it, est. speed input: 12.45 toks/s, output: 21.60 toks/s]Processed prompts:   3%|▎         | 5/170 [00:35<12:50,  4.67s/it, est. speed input: 14.53 toks/s, output: 28.41 toks/s]Processed prompts:   4%|▎         | 6/170 [00:36<09:06,  3.33s/it, est. speed input: 16.87 toks/s, output: 35.40 toks/s]Processed prompts:   4%|▍         | 7/170 [00:36<06:40,  2.45s/it, est. speed input: 19.90 toks/s, output: 42.44 toks/s]Processed prompts:   5%|▍         | 8/170 [00:37<05:24,  2.01s/it, est. speed input: 21.36 toks/s, output: 49.05 toks/s]Processed prompts:   5%|▌         | 9/170 [00:40<05:45,  2.14s/it, est. speed input: 23.42 toks/s, output: 54.15 toks/s]Processed prompts:   6%|▌         | 10/170 [00:40<04:20,  1.63s/it, est. speed input: 24.87 toks/s, output: 61.68 toks/s]Processed prompts:   6%|▋         | 11/170 [00:43<05:14,  1.98s/it, est. speed input: 25.93 toks/s, output: 66.20 toks/s]Processed prompts:   7%|▋         | 12/170 [00:43<04:02,  1.54s/it, est. speed input: 27.72 toks/s, output: 73.91 toks/s]Processed prompts:   8%|▊         | 13/170 [00:44<03:34,  1.37s/it, est. speed input: 29.45 toks/s, output: 80.91 toks/s]Processed prompts:   8%|▊         | 14/170 [00:47<04:24,  1.70s/it, est. speed input: 29.92 toks/s, output: 85.57 toks/s]Processed prompts:   9%|▉         | 15/170 [00:47<03:10,  1.23s/it, est. speed input: 34.92 toks/s, output: 94.18 toks/s]Processed prompts:   9%|▉         | 16/170 [00:48<02:38,  1.03s/it, est. speed input: 36.94 toks/s, output: 101.95 toks/s]Processed prompts:  10%|█         | 17/170 [00:48<02:27,  1.04it/s, est. speed input: 38.25 toks/s, output: 109.22 toks/s]Processed prompts:  11%|█         | 18/170 [00:49<02:29,  1.02it/s, est. speed input: 39.91 toks/s, output: 116.02 toks/s]Processed prompts:  11%|█         | 19/170 [00:50<02:03,  1.22it/s, est. speed input: 42.68 toks/s, output: 124.12 toks/s]Processed prompts:  12%|█▏        | 20/170 [00:50<01:51,  1.34it/s, est. speed input: 44.22 toks/s, output: 131.85 toks/s]Processed prompts:  12%|█▏        | 21/170 [00:53<03:17,  1.32s/it, est. speed input: 47.22 toks/s, output: 134.67 toks/s]Processed prompts:  13%|█▎        | 22/170 [00:54<03:13,  1.31s/it, est. speed input: 48.24 toks/s, output: 140.98 toks/s]WARNING 01-28 01:12:16 scheduler.py:1558] Sequence group 282 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=151
Processed prompts:  14%|█▍        | 24/170 [00:55<02:15,  1.07it/s, est. speed input: 51.54 toks/s, output: 157.26 toks/s]Processed prompts:  15%|█▍        | 25/170 [00:56<02:17,  1.06it/s, est. speed input: 52.74 toks/s, output: 164.08 toks/s]Processed prompts:  15%|█▌        | 26/170 [00:59<03:02,  1.27s/it, est. speed input: 55.19 toks/s, output: 167.73 toks/s]Processed prompts:  16%|█▌        | 27/170 [00:59<02:36,  1.09s/it, est. speed input: 56.52 toks/s, output: 175.69 toks/s]Processed prompts:  16%|█▋        | 28/170 [01:00<02:22,  1.00s/it, est. speed input: 58.38 toks/s, output: 183.22 toks/s]Processed prompts:  17%|█▋        | 29/170 [01:00<02:00,  1.17it/s, est. speed input: 59.40 toks/s, output: 191.58 toks/s]Processed prompts:  18%|█▊        | 30/170 [01:01<01:50,  1.27it/s, est. speed input: 60.32 toks/s, output: 199.51 toks/s]Processed prompts:  18%|█▊        | 31/170 [01:02<01:39,  1.39it/s, est. speed input: 61.66 toks/s, output: 207.64 toks/s]Processed prompts:  19%|█▉        | 32/170 [01:02<01:31,  1.50it/s, est. speed input: 62.66 toks/s, output: 215.76 toks/s]Processed prompts:  19%|█▉        | 33/170 [01:04<02:30,  1.10s/it, est. speed input: 62.53 toks/s, output: 218.71 toks/s]Processed prompts:  20%|██        | 34/170 [01:05<02:04,  1.09it/s, est. speed input: 63.63 toks/s, output: 227.19 toks/s]Processed prompts:  21%|██        | 35/170 [01:05<01:41,  1.33it/s, est. speed input: 65.13 toks/s, output: 235.96 toks/s]Processed prompts:  21%|██        | 36/170 [01:06<01:48,  1.23it/s, est. speed input: 66.33 toks/s, output: 242.66 toks/s]Processed prompts:  22%|██▏       | 37/170 [01:07<01:34,  1.41it/s, est. speed input: 69.02 toks/s, output: 251.03 toks/s]Processed prompts:  22%|██▏       | 38/170 [01:07<01:18,  1.68it/s, est. speed input: 73.96 toks/s, output: 259.86 toks/s]Processed prompts:  23%|██▎       | 39/170 [01:07<01:10,  1.86it/s, est. speed input: 75.75 toks/s, output: 268.34 toks/s]Processed prompts:  24%|██▎       | 40/170 [01:08<01:15,  1.73it/s, est. speed input: 76.32 toks/s, output: 275.75 toks/s]Processed prompts:  24%|██▍       | 41/170 [01:09<01:19,  1.61it/s, est. speed input: 76.86 toks/s, output: 282.99 toks/s]Processed prompts:  25%|██▍       | 42/170 [01:09<01:00,  2.12it/s, est. speed input: 79.14 toks/s, output: 292.56 toks/s]Processed prompts:  25%|██▌       | 43/170 [01:10<01:25,  1.49it/s, est. speed input: 81.79 toks/s, output: 297.96 toks/s]Processed prompts:  26%|██▌       | 44/170 [01:10<01:06,  1.89it/s, est. speed input: 83.26 toks/s, output: 307.24 toks/s]Processed prompts:  26%|██▋       | 45/170 [01:11<01:14,  1.68it/s, est. speed input: 85.34 toks/s, output: 314.05 toks/s]Processed prompts:  28%|██▊       | 47/170 [01:12<01:00,  2.02it/s, est. speed input: 87.64 toks/s, output: 330.83 toks/s]Processed prompts:  28%|██▊       | 48/170 [01:13<01:20,  1.51it/s, est. speed input: 89.05 toks/s, output: 335.70 toks/s]Processed prompts:  29%|██▉       | 49/170 [01:13<01:07,  1.80it/s, est. speed input: 91.58 toks/s, output: 344.69 toks/s]Processed prompts:  29%|██▉       | 50/170 [01:13<00:54,  2.18it/s, est. speed input: 93.08 toks/s, output: 350.18 toks/s]Processed prompts:  30%|███       | 51/170 [01:14<00:59,  2.02it/s, est. speed input: 95.23 toks/s, output: 357.54 toks/s]Processed prompts:  31%|███       | 52/170 [01:14<01:02,  1.88it/s, est. speed input: 97.20 toks/s, output: 364.72 toks/s]Processed prompts:  31%|███       | 53/170 [01:17<02:00,  1.03s/it, est. speed input: 95.77 toks/s, output: 359.80 toks/s]Processed prompts:  33%|███▎      | 56/170 [01:17<01:01,  1.84it/s, est. speed input: 101.06 toks/s, output: 388.39 toks/s]Processed prompts:  34%|███▎      | 57/170 [01:18<01:15,  1.50it/s, est. speed input: 101.07 toks/s, output: 391.49 toks/s]Processed prompts:  34%|███▍      | 58/170 [01:19<01:14,  1.51it/s, est. speed input: 101.96 toks/s, output: 398.57 toks/s]Processed prompts:  35%|███▍      | 59/170 [01:19<01:02,  1.77it/s, est. speed input: 103.49 toks/s, output: 407.45 toks/s]Processed prompts:  35%|███▌      | 60/170 [01:21<01:25,  1.29it/s, est. speed input: 104.17 toks/s, output: 410.88 toks/s]Processed prompts:  36%|███▌      | 61/170 [01:22<01:34,  1.15it/s, est. speed input: 104.78 toks/s, output: 415.68 toks/s]Processed prompts:  36%|███▋      | 62/170 [01:22<01:11,  1.51it/s, est. speed input: 106.59 toks/s, output: 420.05 toks/s]Processed prompts:  37%|███▋      | 63/170 [01:22<00:55,  1.93it/s, est. speed input: 108.48 toks/s, output: 426.97 toks/s]Processed prompts:  38%|███▊      | 64/170 [01:23<01:18,  1.36it/s, est. speed input: 110.11 toks/s, output: 430.85 toks/s]Processed prompts:  38%|███▊      | 65/170 [01:24<01:22,  1.27it/s, est. speed input: 110.73 toks/s, output: 436.61 toks/s]Processed prompts:  39%|███▉      | 66/170 [01:25<01:23,  1.24it/s, est. speed input: 113.58 toks/s, output: 442.73 toks/s]Processed prompts:  39%|███▉      | 67/170 [01:26<01:13,  1.41it/s, est. speed input: 114.12 toks/s, output: 449.67 toks/s]Processed prompts:  40%|████      | 68/170 [01:26<01:18,  1.30it/s, est. speed input: 114.97 toks/s, output: 455.40 toks/s]Processed prompts:  41%|████      | 69/170 [01:27<01:18,  1.29it/s, est. speed input: 116.50 toks/s, output: 461.80 toks/s]Processed prompts:  41%|████      | 70/170 [01:28<01:17,  1.29it/s, est. speed input: 117.53 toks/s, output: 468.20 toks/s]Processed prompts:  42%|████▏     | 71/170 [01:28<01:08,  1.45it/s, est. speed input: 118.97 toks/s, output: 476.07 toks/s]Processed prompts:  42%|████▏     | 72/170 [01:30<01:26,  1.13it/s, est. speed input: 118.48 toks/s, output: 473.29 toks/s]Processed prompts:  43%|████▎     | 73/170 [01:30<01:15,  1.29it/s, est. speed input: 119.43 toks/s, output: 481.12 toks/s]Processed prompts:  44%|████▎     | 74/170 [01:32<01:32,  1.03it/s, est. speed input: 119.40 toks/s, output: 484.29 toks/s]Processed prompts:  44%|████▍     | 75/170 [01:32<01:08,  1.40it/s, est. speed input: 123.46 toks/s, output: 494.18 toks/s]Processed prompts:  45%|████▍     | 76/170 [01:33<01:05,  1.44it/s, est. speed input: 124.49 toks/s, output: 499.29 toks/s]Processed prompts:  45%|████▌     | 77/170 [01:33<00:50,  1.83it/s, est. speed input: 126.30 toks/s, output: 508.57 toks/s]Processed prompts:  46%|████▌     | 78/170 [01:34<01:11,  1.28it/s, est. speed input: 126.73 toks/s, output: 510.28 toks/s]Processed prompts:  46%|████▋     | 79/170 [01:34<00:53,  1.71it/s, est. speed input: 128.60 toks/s, output: 520.11 toks/s]Processed prompts:  47%|████▋     | 80/170 [01:35<00:58,  1.54it/s, est. speed input: 129.07 toks/s, output: 518.70 toks/s]Processed prompts:  48%|████▊     | 81/170 [01:36<00:56,  1.58it/s, est. speed input: 129.86 toks/s, output: 526.05 toks/s]Processed prompts:  49%|████▉     | 83/170 [01:37<01:04,  1.34it/s, est. speed input: 132.37 toks/s, output: 537.46 toks/s]Processed prompts:  49%|████▉     | 84/170 [01:38<01:13,  1.17it/s, est. speed input: 132.86 toks/s, output: 537.44 toks/s]Processed prompts:  50%|█████     | 85/170 [01:39<01:07,  1.26it/s, est. speed input: 134.39 toks/s, output: 544.62 toks/s]Processed prompts:  51%|█████     | 86/170 [01:41<01:25,  1.02s/it, est. speed input: 133.55 toks/s, output: 546.44 toks/s]Processed prompts:  52%|█████▏    | 88/170 [01:41<00:59,  1.38it/s, est. speed input: 135.88 toks/s, output: 559.16 toks/s]Processed prompts:  52%|█████▏    | 89/170 [01:42<01:01,  1.31it/s, est. speed input: 137.23 toks/s, output: 564.94 toks/s]Processed prompts:  53%|█████▎    | 90/170 [01:44<01:29,  1.12s/it, est. speed input: 135.75 toks/s, output: 563.94 toks/s]Processed prompts:  54%|█████▎    | 91/170 [01:45<01:21,  1.03s/it, est. speed input: 137.21 toks/s, output: 570.38 toks/s]Processed prompts:  54%|█████▍    | 92/170 [01:46<01:07,  1.16it/s, est. speed input: 137.80 toks/s, output: 573.24 toks/s]Processed prompts:  55%|█████▍    | 93/170 [01:46<00:53,  1.44it/s, est. speed input: 138.63 toks/s, output: 582.48 toks/s]Processed prompts:  55%|█████▌    | 94/170 [01:46<00:46,  1.65it/s, est. speed input: 139.83 toks/s, output: 590.97 toks/s]Processed prompts:  56%|█████▌    | 95/170 [01:47<00:52,  1.44it/s, est. speed input: 141.38 toks/s, output: 593.34 toks/s]Processed prompts:  56%|█████▋    | 96/170 [01:49<01:18,  1.06s/it, est. speed input: 140.66 toks/s, output: 586.32 toks/s]Processed prompts:  57%|█████▋    | 97/170 [01:50<01:21,  1.11s/it, est. speed input: 141.68 toks/s, output: 590.42 toks/s]Processed prompts:  58%|█████▊    | 98/170 [01:52<01:24,  1.17s/it, est. speed input: 141.63 toks/s, output: 594.28 toks/s]Processed prompts:  58%|█████▊    | 99/170 [01:52<01:13,  1.04s/it, est. speed input: 141.51 toks/s, output: 594.85 toks/s]Processed prompts:  59%|█████▉    | 100/170 [01:54<01:16,  1.10s/it, est. speed input: 141.20 toks/s, output: 593.75 toks/s]Processed prompts:  59%|█████▉    | 101/170 [01:56<01:42,  1.49s/it, est. speed input: 139.84 toks/s, output: 592.27 toks/s]Processed prompts:  60%|██████    | 102/170 [01:57<01:20,  1.18s/it, est. speed input: 140.64 toks/s, output: 595.38 toks/s]Processed prompts:  61%|██████    | 103/170 [01:58<01:24,  1.26s/it, est. speed input: 139.73 toks/s, output: 592.83 toks/s]Processed prompts:  61%|██████    | 104/170 [01:59<01:23,  1.27s/it, est. speed input: 139.43 toks/s, output: 593.60 toks/s]Processed prompts:  62%|██████▏   | 105/170 [02:03<02:00,  1.86s/it, est. speed input: 137.22 toks/s, output: 588.98 toks/s]Processed prompts:  62%|██████▏   | 106/170 [02:03<01:34,  1.48s/it, est. speed input: 138.48 toks/s, output: 597.16 toks/s]Processed prompts:  63%|██████▎   | 107/170 [02:04<01:16,  1.21s/it, est. speed input: 139.76 toks/s, output: 605.29 toks/s]Processed prompts:  64%|██████▎   | 108/170 [02:04<01:06,  1.08s/it, est. speed input: 139.99 toks/s, output: 607.29 toks/s]Processed prompts:  64%|██████▍   | 109/170 [02:05<00:47,  1.27it/s, est. speed input: 141.23 toks/s, output: 617.70 toks/s]Processed prompts:  65%|██████▍   | 110/170 [02:05<00:48,  1.24it/s, est. speed input: 141.16 toks/s, output: 616.94 toks/s]Processed prompts:  65%|██████▌   | 111/170 [02:07<00:56,  1.04it/s, est. speed input: 142.37 toks/s, output: 621.37 toks/s]Processed prompts:  66%|██████▌   | 112/170 [02:08<00:55,  1.04it/s, est. speed input: 142.34 toks/s, output: 623.53 toks/s]Processed prompts:  68%|██████▊   | 115/170 [02:10<00:43,  1.25it/s, est. speed input: 146.45 toks/s, output: 634.72 toks/s]Processed prompts:  68%|██████▊   | 116/170 [02:10<00:40,  1.34it/s, est. speed input: 147.09 toks/s, output: 643.00 toks/s]Processed prompts:  69%|██████▉   | 117/170 [02:11<00:41,  1.26it/s, est. speed input: 147.90 toks/s, output: 649.51 toks/s]Processed prompts:  69%|██████▉   | 118/170 [02:12<00:34,  1.49it/s, est. speed input: 148.36 toks/s, output: 653.32 toks/s]Processed prompts:  70%|███████   | 119/170 [02:12<00:27,  1.84it/s, est. speed input: 152.58 toks/s, output: 663.50 toks/s]Processed prompts:  71%|███████   | 121/170 [02:13<00:29,  1.65it/s, est. speed input: 154.50 toks/s, output: 673.95 toks/s]Processed prompts:  72%|███████▏  | 123/170 [02:13<00:20,  2.26it/s, est. speed input: 157.21 toks/s, output: 691.23 toks/s]Processed prompts:  73%|███████▎  | 124/170 [02:14<00:25,  1.84it/s, est. speed input: 156.92 toks/s, output: 692.25 toks/s]Processed prompts:  74%|███████▎  | 125/170 [02:15<00:23,  1.95it/s, est. speed input: 157.25 toks/s, output: 693.44 toks/s]Processed prompts:  74%|███████▍  | 126/170 [02:18<00:48,  1.10s/it, est. speed input: 155.47 toks/s, output: 683.58 toks/s]Processed prompts:  75%|███████▍  | 127/170 [02:19<00:55,  1.28s/it, est. speed input: 156.72 toks/s, output: 686.29 toks/s]Processed prompts:  75%|███████▌  | 128/170 [02:20<00:40,  1.04it/s, est. speed input: 158.78 toks/s, output: 691.90 toks/s]Processed prompts:  76%|███████▌  | 129/170 [02:20<00:34,  1.20it/s, est. speed input: 159.31 toks/s, output: 694.61 toks/s]Processed prompts:  76%|███████▋  | 130/170 [02:21<00:31,  1.27it/s, est. speed input: 160.91 toks/s, output: 697.38 toks/s]Processed prompts:  77%|███████▋  | 131/170 [02:21<00:25,  1.53it/s, est. speed input: 161.46 toks/s, output: 701.29 toks/s]Processed prompts:  78%|███████▊  | 132/170 [02:22<00:26,  1.46it/s, est. speed input: 161.39 toks/s, output: 704.46 toks/s]Processed prompts:  78%|███████▊  | 133/170 [02:23<00:26,  1.41it/s, est. speed input: 162.46 toks/s, output: 712.29 toks/s]Processed prompts:  79%|███████▉  | 134/170 [02:23<00:21,  1.64it/s, est. speed input: 163.69 toks/s, output: 722.02 toks/s]Processed prompts:  79%|███████▉  | 135/170 [02:23<00:16,  2.11it/s, est. speed input: 165.71 toks/s, output: 732.81 toks/s]Processed prompts:  80%|████████  | 136/170 [02:23<00:13,  2.44it/s, est. speed input: 166.03 toks/s, output: 736.29 toks/s]Processed prompts:  81%|████████  | 137/170 [02:24<00:11,  3.00it/s, est. speed input: 170.64 toks/s, output: 744.95 toks/s]Processed prompts:  81%|████████  | 138/170 [02:24<00:12,  2.50it/s, est. speed input: 171.01 toks/s, output: 748.29 toks/s]Processed prompts:  82%|████████▏ | 139/170 [02:25<00:14,  2.12it/s, est. speed input: 171.35 toks/s, output: 753.45 toks/s]Processed prompts:  82%|████████▏ | 140/170 [02:26<00:16,  1.77it/s, est. speed input: 171.21 toks/s, output: 756.52 toks/s]Processed prompts:  83%|████████▎ | 141/170 [02:26<00:13,  2.21it/s, est. speed input: 172.06 toks/s, output: 762.16 toks/s]Processed prompts:  84%|████████▎ | 142/170 [02:26<00:14,  1.99it/s, est. speed input: 173.51 toks/s, output: 770.73 toks/s]Processed prompts:  84%|████████▍ | 143/170 [02:27<00:18,  1.45it/s, est. speed input: 173.74 toks/s, output: 770.84 toks/s]Processed prompts:  85%|████████▍ | 144/170 [02:28<00:17,  1.44it/s, est. speed input: 174.38 toks/s, output: 775.60 toks/s]Processed prompts:  85%|████████▌ | 145/170 [02:29<00:19,  1.31it/s, est. speed input: 174.31 toks/s, output: 779.58 toks/s]Processed prompts:  86%|████████▌ | 146/170 [02:30<00:16,  1.44it/s, est. speed input: 175.59 toks/s, output: 782.33 toks/s]Processed prompts:  86%|████████▋ | 147/170 [02:32<00:24,  1.08s/it, est. speed input: 174.88 toks/s, output: 778.57 toks/s]Processed prompts:  87%|████████▋ | 148/170 [02:32<00:21,  1.04it/s, est. speed input: 175.09 toks/s, output: 781.96 toks/s]Processed prompts:  88%|████████▊ | 149/170 [02:33<00:18,  1.13it/s, est. speed input: 176.43 toks/s, output: 785.37 toks/s]Processed prompts:  88%|████████▊ | 150/170 [02:33<00:14,  1.33it/s, est. speed input: 177.73 toks/s, output: 787.57 toks/s]Processed prompts:  89%|████████▉ | 151/170 [02:34<00:10,  1.78it/s, est. speed input: 178.62 toks/s, output: 799.19 toks/s]Processed prompts:  90%|█████████ | 153/170 [02:37<00:18,  1.10s/it, est. speed input: 176.37 toks/s, output: 794.40 toks/s]Processed prompts:  91%|█████████ | 154/170 [02:37<00:14,  1.10it/s, est. speed input: 177.95 toks/s, output: 799.46 toks/s]Processed prompts:  92%|█████████▏| 156/170 [02:38<00:09,  1.51it/s, est. speed input: 182.57 toks/s, output: 811.40 toks/s]Processed prompts:  92%|█████████▏| 157/170 [02:38<00:07,  1.75it/s, est. speed input: 184.90 toks/s, output: 818.13 toks/s]Processed prompts:  94%|█████████▎| 159/170 [02:39<00:05,  1.86it/s, est. speed input: 186.83 toks/s, output: 823.42 toks/s]Processed prompts:  94%|█████████▍| 160/170 [02:43<00:12,  1.22s/it, est. speed input: 183.69 toks/s, output: 810.60 toks/s]Processed prompts:  95%|█████████▍| 161/170 [02:43<00:09,  1.02s/it, est. speed input: 184.10 toks/s, output: 817.37 toks/s]Processed prompts:  95%|█████████▌| 162/170 [02:44<00:07,  1.02it/s, est. speed input: 184.24 toks/s, output: 818.88 toks/s]Processed prompts:  96%|█████████▌| 163/170 [02:45<00:07,  1.08s/it, est. speed input: 185.05 toks/s, output: 822.33 toks/s]Processed prompts:  97%|█████████▋| 165/170 [02:46<00:03,  1.32it/s, est. speed input: 186.23 toks/s, output: 833.49 toks/s]Processed prompts:  98%|█████████▊| 167/170 [02:48<00:02,  1.34it/s, est. speed input: 187.06 toks/s, output: 840.84 toks/s]Processed prompts:  99%|█████████▉| 168/170 [02:49<00:01,  1.05it/s, est. speed input: 186.92 toks/s, output: 840.16 toks/s]Processed prompts:  99%|█████████▉| 169/170 [02:56<00:02,  2.26s/it, est. speed input: 180.48 toks/s, output: 820.22 toks/s]Processed prompts: 100%|██████████| 170/170 [02:58<00:00,  2.30s/it, est. speed input: 179.41 toks/s, output: 818.46 toks/s]Processed prompts: 100%|██████████| 170/170 [02:58<00:00,  1.05s/it, est. speed input: 179.41 toks/s, output: 818.46 toks/s]
Results for dataset electro_dataset_textonly saved to project/Kaiyue/offline_outputs/CohereForAI_c4ai-command-r-v01/electro_dataset_textonly/response.jsonl.
Processing dataset: project/Kaiyue/datasets/mechanics_dataset_textonly.jsonl
Processing mechanics_dataset_textonly:   0%|          | 0/133 [00:00<?, ?it/s]Processing mechanics_dataset_textonly: 100%|██████████| 133/133 [00:00<00:00, 615041.27it/s]
Processed prompts:   0%|          | 0/133 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   1%|          | 1/133 [00:20<44:52, 20.40s/it, est. speed input: 3.28 toks/s, output: 7.75 toks/s]Processed prompts:   2%|▏         | 2/133 [00:27<26:55, 12.33s/it, est. speed input: 6.53 toks/s, output: 14.29 toks/s]Processed prompts:   2%|▏         | 3/133 [00:31<19:09,  8.84s/it, est. speed input: 8.37 toks/s, output: 20.99 toks/s]WARNING 01-28 01:14:51 scheduler.py:1558] Sequence group 481 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=201
Processed prompts:   3%|▎         | 4/133 [00:32<12:32,  5.83s/it, est. speed input: 12.34 toks/s, output: 29.16 toks/s]Processed prompts:   5%|▍         | 6/133 [00:33<06:11,  2.92s/it, est. speed input: 21.28 toks/s, output: 46.28 toks/s]Processed prompts:   5%|▌         | 7/133 [00:35<05:44,  2.73s/it, est. speed input: 24.26 toks/s, output: 52.49 toks/s]Processed prompts:   6%|▌         | 8/133 [00:37<05:05,  2.44s/it, est. speed input: 28.95 toks/s, output: 59.36 toks/s]Processed prompts:   8%|▊         | 10/133 [00:38<03:11,  1.56s/it, est. speed input: 36.34 toks/s, output: 76.31 toks/s]Processed prompts:   8%|▊         | 11/133 [00:39<02:51,  1.40s/it, est. speed input: 37.70 toks/s, output: 83.91 toks/s]Processed prompts:   9%|▉         | 12/133 [00:41<03:00,  1.49s/it, est. speed input: 39.00 toks/s, output: 89.91 toks/s]Processed prompts:  11%|█         | 14/133 [00:41<01:52,  1.06it/s, est. speed input: 46.88 toks/s, output: 108.01 toks/s]Processed prompts:  11%|█▏        | 15/133 [00:43<02:07,  1.08s/it, est. speed input: 48.53 toks/s, output: 113.78 toks/s]Processed prompts:  12%|█▏        | 16/133 [00:44<02:05,  1.07s/it, est. speed input: 50.70 toks/s, output: 120.80 toks/s]Processed prompts:  13%|█▎        | 17/133 [00:44<01:36,  1.21it/s, est. speed input: 52.78 toks/s, output: 130.10 toks/s]Processed prompts:  14%|█▎        | 18/133 [00:44<01:20,  1.42it/s, est. speed input: 55.91 toks/s, output: 138.76 toks/s]Processed prompts:  14%|█▍        | 19/133 [00:44<01:04,  1.76it/s, est. speed input: 58.57 toks/s, output: 147.84 toks/s]Processed prompts:  15%|█▌        | 20/133 [00:45<00:51,  2.20it/s, est. speed input: 60.52 toks/s, output: 157.00 toks/s]Processed prompts:  16%|█▌        | 21/133 [00:45<00:47,  2.37it/s, est. speed input: 62.01 toks/s, output: 165.52 toks/s]Processed prompts:  17%|█▋        | 22/133 [00:45<00:42,  2.61it/s, est. speed input: 64.74 toks/s, output: 174.18 toks/s]Processed prompts:  17%|█▋        | 23/133 [00:46<00:39,  2.76it/s, est. speed input: 67.26 toks/s, output: 182.69 toks/s]Processed prompts:  19%|█▉        | 25/133 [00:46<00:41,  2.61it/s, est. speed input: 72.34 toks/s, output: 198.71 toks/s]Processed prompts:  20%|█▉        | 26/133 [00:47<00:40,  2.65it/s, est. speed input: 74.48 toks/s, output: 206.86 toks/s]Processed prompts:  20%|██        | 27/133 [00:47<00:33,  3.16it/s, est. speed input: 79.26 toks/s, output: 215.90 toks/s]Processed prompts:  21%|██        | 28/133 [00:47<00:28,  3.72it/s, est. speed input: 83.64 toks/s, output: 224.93 toks/s]Processed prompts:  22%|██▏       | 29/133 [00:49<01:08,  1.51it/s, est. speed input: 83.23 toks/s, output: 226.98 toks/s]Processed prompts:  23%|██▎       | 31/133 [00:50<00:57,  1.79it/s, est. speed input: 87.47 toks/s, output: 242.35 toks/s]Processed prompts:  24%|██▍       | 32/133 [00:50<00:51,  1.96it/s, est. speed input: 89.01 toks/s, output: 250.39 toks/s]Processed prompts:  25%|██▍       | 33/133 [00:51<01:07,  1.48it/s, est. speed input: 89.29 toks/s, output: 254.60 toks/s]Processed prompts:  26%|██▌       | 34/133 [00:51<00:52,  1.87it/s, est. speed input: 91.25 toks/s, output: 263.72 toks/s]Processed prompts:  26%|██▋       | 35/133 [00:52<00:53,  1.84it/s, est. speed input: 92.06 toks/s, output: 270.66 toks/s]Processed prompts:  27%|██▋       | 36/133 [00:53<01:15,  1.29it/s, est. speed input: 95.91 toks/s, output: 273.77 toks/s]Processed prompts:  29%|██▊       | 38/133 [00:54<00:52,  1.80it/s, est. speed input: 102.69 toks/s, output: 290.61 toks/s]Processed prompts:  30%|███       | 40/133 [00:54<00:44,  2.09it/s, est. speed input: 105.40 toks/s, output: 306.53 toks/s]Processed prompts:  31%|███       | 41/133 [00:55<00:55,  1.65it/s, est. speed input: 105.38 toks/s, output: 309.37 toks/s]Processed prompts:  32%|███▏      | 42/133 [00:56<00:48,  1.89it/s, est. speed input: 108.22 toks/s, output: 317.78 toks/s]Processed prompts:  32%|███▏      | 43/133 [00:58<01:17,  1.16it/s, est. speed input: 106.71 toks/s, output: 316.21 toks/s]Processed prompts:  34%|███▍      | 45/133 [00:58<00:55,  1.58it/s, est. speed input: 110.35 toks/s, output: 331.89 toks/s]Processed prompts:  35%|███▍      | 46/133 [00:58<00:46,  1.86it/s, est. speed input: 114.54 toks/s, output: 340.75 toks/s]Processed prompts:  35%|███▌      | 47/133 [00:59<00:54,  1.59it/s, est. speed input: 115.78 toks/s, output: 345.62 toks/s]Processed prompts:  36%|███▌      | 48/133 [01:00<00:51,  1.64it/s, est. speed input: 116.42 toks/s, output: 352.46 toks/s]Processed prompts:  37%|███▋      | 49/133 [01:00<00:47,  1.78it/s, est. speed input: 117.50 toks/s, output: 360.04 toks/s]Processed prompts:  38%|███▊      | 50/133 [01:01<00:54,  1.52it/s, est. speed input: 119.59 toks/s, output: 364.89 toks/s]Processed prompts:  38%|███▊      | 51/133 [01:02<01:02,  1.31it/s, est. speed input: 119.26 toks/s, output: 369.05 toks/s]Processed prompts:  39%|███▉      | 52/133 [01:04<01:29,  1.11s/it, est. speed input: 119.39 toks/s, output: 368.17 toks/s]Processed prompts:  40%|███▉      | 53/133 [01:04<01:06,  1.20it/s, est. speed input: 121.77 toks/s, output: 377.46 toks/s]Processed prompts:  41%|████      | 54/133 [01:06<01:22,  1.04s/it, est. speed input: 120.55 toks/s, output: 379.05 toks/s]Processed prompts:  41%|████▏     | 55/133 [01:06<01:09,  1.13it/s, est. speed input: 122.01 toks/s, output: 386.46 toks/s]Processed prompts:  43%|████▎     | 57/133 [01:07<00:42,  1.78it/s, est. speed input: 126.25 toks/s, output: 403.02 toks/s]Processed prompts:  44%|████▎     | 58/133 [01:08<00:55,  1.35it/s, est. speed input: 129.38 toks/s, output: 405.74 toks/s]Processed prompts:  44%|████▍     | 59/133 [01:09<00:56,  1.31it/s, est. speed input: 131.59 toks/s, output: 411.31 toks/s]Processed prompts:  45%|████▌     | 60/133 [01:09<00:43,  1.66it/s, est. speed input: 133.19 toks/s, output: 420.61 toks/s]Processed prompts:  46%|████▌     | 61/133 [01:10<00:40,  1.77it/s, est. speed input: 134.17 toks/s, output: 428.09 toks/s]Processed prompts:  47%|████▋     | 62/133 [01:11<01:02,  1.14it/s, est. speed input: 134.31 toks/s, output: 428.50 toks/s]Processed prompts:  47%|████▋     | 63/133 [01:12<00:49,  1.41it/s, est. speed input: 135.72 toks/s, output: 437.07 toks/s]Processed prompts:  48%|████▊     | 64/133 [01:13<00:55,  1.25it/s, est. speed input: 136.98 toks/s, output: 441.40 toks/s]Processed prompts:  49%|████▉     | 65/133 [01:13<00:44,  1.53it/s, est. speed input: 139.17 toks/s, output: 449.93 toks/s]Processed prompts:  50%|████▉     | 66/133 [01:14<00:48,  1.37it/s, est. speed input: 140.78 toks/s, output: 454.78 toks/s]Processed prompts:  50%|█████     | 67/133 [01:14<00:40,  1.63it/s, est. speed input: 142.58 toks/s, output: 463.07 toks/s]Processed prompts:  51%|█████     | 68/133 [01:16<00:58,  1.12it/s, est. speed input: 142.09 toks/s, output: 464.06 toks/s]Processed prompts:  52%|█████▏    | 69/133 [01:16<00:51,  1.25it/s, est. speed input: 144.38 toks/s, output: 470.52 toks/s]Processed prompts:  53%|█████▎    | 70/133 [01:16<00:39,  1.61it/s, est. speed input: 146.41 toks/s, output: 479.76 toks/s]Processed prompts:  53%|█████▎    | 71/133 [01:17<00:42,  1.45it/s, est. speed input: 147.21 toks/s, output: 485.01 toks/s]Processed prompts:  55%|█████▍    | 73/133 [01:18<00:26,  2.25it/s, est. speed input: 151.24 toks/s, output: 499.69 toks/s]Processed prompts:  56%|█████▌    | 74/133 [01:19<00:43,  1.37it/s, est. speed input: 149.95 toks/s, output: 494.91 toks/s]Processed prompts:  56%|█████▋    | 75/133 [01:20<00:40,  1.45it/s, est. speed input: 153.65 toks/s, output: 501.99 toks/s]Processed prompts:  57%|█████▋    | 76/133 [01:20<00:32,  1.75it/s, est. speed input: 154.53 toks/s, output: 506.33 toks/s]Processed prompts:  58%|█████▊    | 77/133 [01:20<00:27,  2.07it/s, est. speed input: 158.01 toks/s, output: 515.40 toks/s]Processed prompts:  59%|█████▊    | 78/133 [01:20<00:20,  2.63it/s, est. speed input: 160.51 toks/s, output: 525.28 toks/s]Processed prompts:  60%|██████    | 80/133 [01:21<00:14,  3.59it/s, est. speed input: 164.93 toks/s, output: 544.63 toks/s]Processed prompts:  61%|██████    | 81/133 [01:21<00:14,  3.71it/s, est. speed input: 167.20 toks/s, output: 553.72 toks/s]Processed prompts:  62%|██████▏   | 83/133 [01:21<00:09,  5.45it/s, est. speed input: 170.82 toks/s, output: 574.33 toks/s]Processed prompts:  63%|██████▎   | 84/133 [01:22<00:12,  4.02it/s, est. speed input: 171.96 toks/s, output: 575.47 toks/s]Processed prompts:  64%|██████▍   | 85/133 [01:22<00:13,  3.65it/s, est. speed input: 174.51 toks/s, output: 583.79 toks/s]Processed prompts:  65%|██████▍   | 86/133 [01:23<00:20,  2.27it/s, est. speed input: 175.02 toks/s, output: 588.20 toks/s]Processed prompts:  65%|██████▌   | 87/133 [01:23<00:17,  2.61it/s, est. speed input: 177.21 toks/s, output: 597.46 toks/s]Processed prompts:  66%|██████▌   | 88/133 [01:23<00:14,  3.08it/s, est. speed input: 178.88 toks/s, output: 607.13 toks/s]Processed prompts:  67%|██████▋   | 89/133 [01:24<00:21,  2.05it/s, est. speed input: 179.05 toks/s, output: 611.62 toks/s]Processed prompts:  68%|██████▊   | 90/133 [01:26<00:34,  1.25it/s, est. speed input: 177.89 toks/s, output: 611.55 toks/s]Processed prompts:  69%|██████▉   | 92/133 [01:26<00:19,  2.10it/s, est. speed input: 182.28 toks/s, output: 632.54 toks/s]Processed prompts:  71%|███████   | 94/133 [01:26<00:12,  3.22it/s, est. speed input: 185.63 toks/s, output: 648.31 toks/s]Processed prompts:  74%|███████▎  | 98/133 [01:27<00:12,  2.90it/s, est. speed input: 188.94 toks/s, output: 676.14 toks/s]Processed prompts:  74%|███████▍  | 99/133 [01:28<00:11,  2.95it/s, est. speed input: 190.49 toks/s, output: 685.04 toks/s]Processed prompts:  75%|███████▌  | 100/133 [01:28<00:10,  3.28it/s, est. speed input: 192.80 toks/s, output: 695.15 toks/s]Processed prompts:  76%|███████▌  | 101/133 [01:29<00:12,  2.65it/s, est. speed input: 193.68 toks/s, output: 701.40 toks/s]Processed prompts:  77%|███████▋  | 102/133 [01:29<00:10,  3.08it/s, est. speed input: 194.53 toks/s, output: 711.61 toks/s]Processed prompts:  77%|███████▋  | 103/133 [01:29<00:08,  3.57it/s, est. speed input: 196.19 toks/s, output: 721.83 toks/s]Processed prompts:  79%|███████▉  | 105/133 [01:29<00:05,  5.16it/s, est. speed input: 201.80 toks/s, output: 738.84 toks/s]Processed prompts:  80%|███████▉  | 106/133 [01:29<00:04,  5.51it/s, est. speed input: 205.74 toks/s, output: 749.10 toks/s]Processed prompts:  80%|████████  | 107/133 [01:30<00:05,  4.40it/s, est. speed input: 208.61 toks/s, output: 752.12 toks/s]Processed prompts:  82%|████████▏ | 109/133 [01:30<00:08,  2.95it/s, est. speed input: 210.86 toks/s, output: 763.72 toks/s]Processed prompts:  83%|████████▎ | 110/133 [01:32<00:14,  1.63it/s, est. speed input: 209.07 toks/s, output: 762.71 toks/s]Processed prompts:  83%|████████▎ | 111/133 [01:34<00:21,  1.03it/s, est. speed input: 206.24 toks/s, output: 758.00 toks/s]Processed prompts:  84%|████████▍ | 112/133 [01:35<00:22,  1.05s/it, est. speed input: 205.38 toks/s, output: 754.82 toks/s]Processed prompts:  85%|████████▍ | 113/133 [01:36<00:16,  1.20it/s, est. speed input: 206.82 toks/s, output: 764.95 toks/s]Processed prompts:  86%|████████▋ | 115/133 [01:38<00:15,  1.14it/s, est. speed input: 206.68 toks/s, output: 769.71 toks/s]Processed prompts:  87%|████████▋ | 116/133 [01:38<00:11,  1.43it/s, est. speed input: 210.66 toks/s, output: 781.12 toks/s]Processed prompts:  89%|████████▊ | 118/133 [01:38<00:07,  1.91it/s, est. speed input: 214.15 toks/s, output: 799.19 toks/s]Processed prompts:  89%|████████▉ | 119/133 [01:39<00:08,  1.61it/s, est. speed input: 213.99 toks/s, output: 804.07 toks/s]Processed prompts:  90%|█████████ | 120/133 [01:41<00:10,  1.21it/s, est. speed input: 213.49 toks/s, output: 805.25 toks/s]Processed prompts:  91%|█████████ | 121/133 [01:41<00:08,  1.39it/s, est. speed input: 214.88 toks/s, output: 810.50 toks/s]Processed prompts:  92%|█████████▏| 122/133 [01:42<00:08,  1.32it/s, est. speed input: 214.17 toks/s, output: 816.55 toks/s]Processed prompts:  92%|█████████▏| 123/133 [01:42<00:05,  1.72it/s, est. speed input: 215.47 toks/s, output: 828.62 toks/s]Processed prompts:  93%|█████████▎| 124/133 [01:46<00:13,  1.46s/it, est. speed input: 210.40 toks/s, output: 809.19 toks/s]Processed prompts:  94%|█████████▍| 125/133 [01:47<00:10,  1.37s/it, est. speed input: 211.37 toks/s, output: 814.15 toks/s]Processed prompts:  95%|█████████▍| 126/133 [01:47<00:07,  1.09s/it, est. speed input: 212.69 toks/s, output: 824.59 toks/s]Processed prompts:  95%|█████████▌| 127/133 [01:48<00:05,  1.11it/s, est. speed input: 213.76 toks/s, output: 834.91 toks/s]Processed prompts:  96%|█████████▌| 128/133 [01:54<00:12,  2.55s/it, est. speed input: 203.18 toks/s, output: 802.38 toks/s]Processed prompts:  97%|█████████▋| 129/133 [01:56<00:08,  2.22s/it, est. speed input: 202.16 toks/s, output: 804.08 toks/s]Processed prompts:  98%|█████████▊| 131/133 [01:57<00:02,  1.48s/it, est. speed input: 204.08 toks/s, output: 825.32 toks/s]Processed prompts:  99%|█████████▉| 132/133 [02:00<00:01,  1.86s/it, est. speed input: 200.47 toks/s, output: 820.14 toks/s]Processed prompts: 100%|██████████| 133/133 [02:00<00:00,  1.47s/it, est. speed input: 203.48 toks/s, output: 828.70 toks/s]Processed prompts: 100%|██████████| 133/133 [02:00<00:00,  1.10it/s, est. speed input: 203.48 toks/s, output: 828.70 toks/s]
Results for dataset mechanics_dataset_textonly saved to project/Kaiyue/offline_outputs/CohereForAI_c4ai-command-r-v01/mechanics_dataset_textonly/response.jsonl.
Processing dataset: project/Kaiyue/datasets/optics_dataset_textonly.jsonl
Processing optics_dataset_textonly:   0%|          | 0/93 [00:00<?, ?it/s]Processing optics_dataset_textonly: 100%|██████████| 93/93 [00:00<00:00, 995077.22it/s]
Processed prompts:   0%|          | 0/93 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   1%|          | 1/93 [00:17<27:26, 17.90s/it, est. speed input: 5.14 toks/s, output: 12.63 toks/s]Processed prompts:   2%|▏         | 2/93 [00:18<11:52,  7.83s/it, est. speed input: 10.33 toks/s, output: 24.84 toks/s]Processed prompts:   3%|▎         | 3/93 [00:19<06:36,  4.40s/it, est. speed input: 14.68 toks/s, output: 37.20 toks/s]Processed prompts:   4%|▍         | 4/93 [00:20<04:52,  3.28s/it, est. speed input: 19.74 toks/s, output: 47.35 toks/s]Processed prompts:   5%|▌         | 5/93 [00:21<03:36,  2.46s/it, est. speed input: 26.02 toks/s, output: 58.26 toks/s]Processed prompts:   6%|▋         | 6/93 [00:22<02:42,  1.86s/it, est. speed input: 29.27 toks/s, output: 69.55 toks/s]Processed prompts:   8%|▊         | 7/93 [00:25<03:07,  2.18s/it, est. speed input: 36.82 toks/s, output: 75.11 toks/s]Processed prompts:   9%|▊         | 8/93 [00:26<02:36,  1.84s/it, est. speed input: 43.78 toks/s, output: 85.35 toks/s]Processed prompts:  10%|▉         | 9/93 [00:27<02:17,  1.64s/it, est. speed input: 48.14 toks/s, output: 95.15 toks/s]Processed prompts:  11%|█         | 10/93 [00:27<01:42,  1.24s/it, est. speed input: 52.82 toks/s, output: 107.55 toks/s]Processed prompts:  12%|█▏        | 11/93 [00:28<01:20,  1.02it/s, est. speed input: 56.83 toks/s, output: 119.59 toks/s]Processed prompts:  13%|█▎        | 12/93 [00:28<00:58,  1.38it/s, est. speed input: 60.03 toks/s, output: 132.61 toks/s]Processed prompts:  14%|█▍        | 13/93 [00:28<00:56,  1.42it/s, est. speed input: 62.25 toks/s, output: 143.18 toks/s]Processed prompts:  15%|█▌        | 14/93 [00:30<01:05,  1.21it/s, est. speed input: 63.60 toks/s, output: 151.55 toks/s]Processed prompts:  17%|█▋        | 16/93 [00:30<00:40,  1.92it/s, est. speed input: 69.10 toks/s, output: 177.16 toks/s]Processed prompts:  18%|█▊        | 17/93 [00:30<00:34,  2.19it/s, est. speed input: 73.70 toks/s, output: 189.35 toks/s]Processed prompts:  19%|█▉        | 18/93 [00:30<00:30,  2.47it/s, est. speed input: 76.38 toks/s, output: 201.48 toks/s]Processed prompts:  20%|██        | 19/93 [00:31<00:24,  3.03it/s, est. speed input: 80.67 toks/s, output: 214.36 toks/s]Processed prompts:  22%|██▏       | 20/93 [00:31<00:35,  2.04it/s, est. speed input: 81.92 toks/s, output: 222.07 toks/s]Processed prompts:  23%|██▎       | 21/93 [00:32<00:27,  2.58it/s, est. speed input: 88.14 toks/s, output: 234.95 toks/s]Processed prompts:  25%|██▍       | 23/93 [00:32<00:23,  2.93it/s, est. speed input: 93.10 toks/s, output: 258.26 toks/s]Processed prompts:  26%|██▌       | 24/93 [00:32<00:23,  2.99it/s, est. speed input: 96.31 toks/s, output: 269.63 toks/s]Processed prompts:  28%|██▊       | 26/93 [00:33<00:26,  2.57it/s, est. speed input: 100.46 toks/s, output: 289.56 toks/s]Processed prompts:  30%|███       | 28/93 [00:34<00:22,  2.87it/s, est. speed input: 108.24 toks/s, output: 312.47 toks/s]Processed prompts:  31%|███       | 29/93 [00:35<00:32,  1.97it/s, est. speed input: 109.29 toks/s, output: 316.67 toks/s]Processed prompts:  33%|███▎      | 31/93 [00:36<00:35,  1.75it/s, est. speed input: 116.39 toks/s, output: 332.69 toks/s]Processed prompts:  34%|███▍      | 32/93 [00:37<00:34,  1.78it/s, est. speed input: 117.34 toks/s, output: 342.15 toks/s]Processed prompts:  35%|███▌      | 33/93 [00:37<00:27,  2.18it/s, est. speed input: 120.04 toks/s, output: 355.25 toks/s]Processed prompts:  37%|███▋      | 34/93 [00:37<00:23,  2.48it/s, est. speed input: 123.64 toks/s, output: 367.24 toks/s]Processed prompts:  39%|███▊      | 36/93 [00:37<00:14,  3.85it/s, est. speed input: 131.31 toks/s, output: 394.47 toks/s]Processed prompts:  40%|███▉      | 37/93 [00:38<00:20,  2.80it/s, est. speed input: 132.54 toks/s, output: 401.70 toks/s]Processed prompts:  42%|████▏     | 39/93 [00:39<00:25,  2.12it/s, est. speed input: 135.76 toks/s, output: 416.89 toks/s]Processed prompts:  43%|████▎     | 40/93 [00:40<00:25,  2.04it/s, est. speed input: 136.00 toks/s, output: 425.54 toks/s]Processed prompts:  44%|████▍     | 41/93 [00:40<00:24,  2.08it/s, est. speed input: 137.97 toks/s, output: 435.35 toks/s]Processed prompts:  45%|████▌     | 42/93 [00:41<00:21,  2.33it/s, est. speed input: 140.22 toks/s, output: 446.89 toks/s]Processed prompts:  47%|████▋     | 44/93 [00:42<00:21,  2.25it/s, est. speed input: 143.64 toks/s, output: 465.70 toks/s]Processed prompts:  48%|████▊     | 45/93 [00:42<00:18,  2.55it/s, est. speed input: 145.82 toks/s, output: 477.86 toks/s]Processed prompts:  49%|████▉     | 46/93 [00:42<00:17,  2.67it/s, est. speed input: 147.98 toks/s, output: 488.86 toks/s]Processed prompts:  52%|█████▏    | 48/93 [00:42<00:10,  4.14it/s, est. speed input: 154.70 toks/s, output: 516.83 toks/s]Processed prompts:  55%|█████▍    | 51/93 [00:43<00:07,  5.66it/s, est. speed input: 162.47 toks/s, output: 556.80 toks/s]Processed prompts:  56%|█████▌    | 52/93 [00:43<00:12,  3.29it/s, est. speed input: 164.98 toks/s, output: 560.49 toks/s]Processed prompts:  57%|█████▋    | 53/93 [00:44<00:14,  2.71it/s, est. speed input: 164.97 toks/s, output: 567.57 toks/s]Processed prompts:  58%|█████▊    | 54/93 [00:45<00:16,  2.31it/s, est. speed input: 166.58 toks/s, output: 574.29 toks/s]Processed prompts:  60%|██████    | 56/93 [00:45<00:10,  3.43it/s, est. speed input: 176.07 toks/s, output: 602.15 toks/s]Processed prompts:  61%|██████▏   | 57/93 [00:45<00:10,  3.31it/s, est. speed input: 179.83 toks/s, output: 612.59 toks/s]Processed prompts:  62%|██████▏   | 58/93 [00:45<00:09,  3.77it/s, est. speed input: 182.92 toks/s, output: 625.61 toks/s]Processed prompts:  63%|██████▎   | 59/93 [00:46<00:08,  3.86it/s, est. speed input: 183.98 toks/s, output: 637.34 toks/s]Processed prompts:  66%|██████▌   | 61/93 [00:46<00:09,  3.34it/s, est. speed input: 188.69 toks/s, output: 657.54 toks/s]Processed prompts:  67%|██████▋   | 62/93 [00:47<00:10,  3.07it/s, est. speed input: 190.89 toks/s, output: 666.93 toks/s]Processed prompts:  68%|██████▊   | 63/93 [00:48<00:15,  1.89it/s, est. speed input: 188.20 toks/s, output: 666.45 toks/s]Processed prompts:  69%|██████▉   | 64/93 [00:49<00:17,  1.68it/s, est. speed input: 189.23 toks/s, output: 671.33 toks/s]Processed prompts:  70%|██████▉   | 65/93 [00:49<00:14,  1.88it/s, est. speed input: 191.22 toks/s, output: 681.86 toks/s]Processed prompts:  71%|███████   | 66/93 [00:49<00:14,  1.92it/s, est. speed input: 192.62 toks/s, output: 690.63 toks/s]Processed prompts:  73%|███████▎  | 68/93 [00:50<00:07,  3.14it/s, est. speed input: 196.76 toks/s, output: 719.85 toks/s]Processed prompts:  74%|███████▍  | 69/93 [00:50<00:07,  3.07it/s, est. speed input: 198.00 toks/s, output: 730.48 toks/s]Processed prompts:  75%|███████▌  | 70/93 [00:51<00:11,  1.94it/s, est. speed input: 195.28 toks/s, output: 731.18 toks/s]Processed prompts:  76%|███████▋  | 71/93 [00:52<00:13,  1.63it/s, est. speed input: 194.26 toks/s, output: 734.70 toks/s]Processed prompts:  77%|███████▋  | 72/93 [00:53<00:13,  1.59it/s, est. speed input: 194.81 toks/s, output: 741.37 toks/s]Processed prompts:  78%|███████▊  | 73/93 [00:53<00:11,  1.72it/s, est. speed input: 196.45 toks/s, output: 751.06 toks/s]Processed prompts:  80%|███████▉  | 74/93 [00:54<00:13,  1.39it/s, est. speed input: 196.26 toks/s, output: 752.64 toks/s]Processed prompts:  81%|████████  | 75/93 [00:54<00:09,  1.83it/s, est. speed input: 199.33 toks/s, output: 767.20 toks/s]Processed prompts:  82%|████████▏ | 76/93 [00:55<00:11,  1.49it/s, est. speed input: 201.82 toks/s, output: 770.31 toks/s]Processed prompts:  83%|████████▎ | 77/93 [00:56<00:09,  1.70it/s, est. speed input: 205.67 toks/s, output: 781.31 toks/s]Processed prompts:  85%|████████▍ | 79/93 [00:56<00:05,  2.45it/s, est. speed input: 210.14 toks/s, output: 808.83 toks/s]Processed prompts:  86%|████████▌ | 80/93 [00:56<00:04,  2.61it/s, est. speed input: 211.96 toks/s, output: 821.05 toks/s]Processed prompts:  89%|████████▉ | 83/93 [00:57<00:03,  2.57it/s, est. speed input: 216.54 toks/s, output: 853.55 toks/s]Processed prompts:  90%|█████████ | 84/93 [00:59<00:04,  1.86it/s, est. speed input: 214.01 toks/s, output: 854.08 toks/s]Processed prompts:  91%|█████████▏| 85/93 [00:59<00:04,  1.98it/s, est. speed input: 217.50 toks/s, output: 865.57 toks/s]Processed prompts:  92%|█████████▏| 86/93 [00:59<00:02,  2.40it/s, est. speed input: 221.81 toks/s, output: 880.71 toks/s]Processed prompts:  94%|█████████▎| 87/93 [01:00<00:02,  2.47it/s, est. speed input: 224.56 toks/s, output: 892.52 toks/s]Processed prompts:  95%|█████████▍| 88/93 [01:03<00:06,  1.28s/it, est. speed input: 214.01 toks/s, output: 858.76 toks/s]Processed prompts:  97%|█████████▋| 90/93 [01:04<00:02,  1.07it/s, est. speed input: 220.42 toks/s, output: 881.76 toks/s]Processed prompts:  98%|█████████▊| 91/93 [01:05<00:01,  1.17it/s, est. speed input: 221.51 toks/s, output: 892.42 toks/s]Processed prompts:  99%|█████████▉| 92/93 [01:06<00:00,  1.21it/s, est. speed input: 221.21 toks/s, output: 900.91 toks/s]Processed prompts: 100%|██████████| 93/93 [01:07<00:00,  1.00it/s, est. speed input: 218.96 toks/s, output: 900.09 toks/s]Processed prompts: 100%|██████████| 93/93 [01:07<00:00,  1.38it/s, est. speed input: 218.96 toks/s, output: 900.09 toks/s]
Results for dataset optics_dataset_textonly saved to project/Kaiyue/offline_outputs/CohereForAI_c4ai-command-r-v01/optics_dataset_textonly/response.jsonl.
Processing dataset: project/Kaiyue/datasets/quantum_dataset_textonly.jsonl
Processing quantum_dataset_textonly:   0%|          | 0/204 [00:00<?, ?it/s]Processing quantum_dataset_textonly: 100%|██████████| 204/204 [00:00<00:00, 760567.13it/s]
Processed prompts:   0%|          | 0/204 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]WARNING 01-28 01:17:47 scheduler.py:1558] Sequence group 777 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=251
WARNING 01-28 01:17:59 scheduler.py:1558] Sequence group 727 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=301
Processed prompts:   0%|          | 1/204 [00:39<2:12:14, 39.08s/it, est. speed input: 6.73 toks/s, output: 6.68 toks/s]Processed prompts:   1%|          | 2/204 [00:46<1:09:15, 20.57s/it, est. speed input: 7.17 toks/s, output: 13.28 toks/s]Processed prompts:   1%|▏         | 3/204 [00:48<40:38, 12.13s/it, est. speed input: 12.32 toks/s, output: 20.64 toks/s] WARNING 01-28 01:18:17 scheduler.py:1558] Sequence group 677 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=351
Processed prompts:   2%|▏         | 4/204 [00:51<27:52,  8.36s/it, est. speed input: 13.74 toks/s, output: 27.81 toks/s]Processed prompts:   3%|▎         | 6/204 [00:53<14:33,  4.41s/it, est. speed input: 19.78 toks/s, output: 43.20 toks/s]Processed prompts:   3%|▎         | 7/204 [00:55<12:43,  3.87s/it, est. speed input: 21.46 toks/s, output: 49.94 toks/s]Processed prompts:   4%|▍         | 8/204 [00:57<11:07,  3.41s/it, est. speed input: 24.30 toks/s, output: 56.88 toks/s]Processed prompts:   4%|▍         | 9/204 [01:01<11:30,  3.54s/it, est. speed input: 25.88 toks/s, output: 62.49 toks/s]Processed prompts:   5%|▍         | 10/204 [01:03<09:37,  2.98s/it, est. speed input: 27.80 toks/s, output: 70.22 toks/s]Processed prompts:   5%|▌         | 11/204 [01:03<07:13,  2.25s/it, est. speed input: 30.49 toks/s, output: 79.04 toks/s]Processed prompts:   6%|▋         | 13/204 [01:04<04:23,  1.38s/it, est. speed input: 33.81 toks/s, output: 96.82 toks/s]Processed prompts:   7%|▋         | 14/204 [01:05<03:59,  1.26s/it, est. speed input: 34.49 toks/s, output: 104.93 toks/s]Processed prompts:   7%|▋         | 15/204 [01:05<03:06,  1.02it/s, est. speed input: 36.98 toks/s, output: 114.05 toks/s]Processed prompts:   8%|▊         | 16/204 [01:06<03:11,  1.02s/it, est. speed input: 38.56 toks/s, output: 121.66 toks/s]Processed prompts:   8%|▊         | 17/204 [01:07<02:34,  1.21it/s, est. speed input: 40.00 toks/s, output: 130.56 toks/s]Processed prompts:   9%|▉         | 18/204 [01:07<01:57,  1.58it/s, est. speed input: 42.98 toks/s, output: 139.82 toks/s]Processed prompts:   9%|▉         | 19/204 [01:09<03:03,  1.01it/s, est. speed input: 45.24 toks/s, output: 145.63 toks/s]Processed prompts:  10%|▉         | 20/204 [01:09<02:15,  1.35it/s, est. speed input: 47.20 toks/s, output: 154.96 toks/s]Processed prompts:  10%|█         | 21/204 [01:09<02:07,  1.44it/s, est. speed input: 48.87 toks/s, output: 163.25 toks/s]Processed prompts:  11%|█         | 22/204 [01:10<01:48,  1.68it/s, est. speed input: 49.57 toks/s, output: 172.00 toks/s]Processed prompts:  11%|█▏        | 23/204 [01:10<01:40,  1.81it/s, est. speed input: 56.54 toks/s, output: 180.52 toks/s]Processed prompts:  12%|█▏        | 24/204 [01:11<01:59,  1.50it/s, est. speed input: 57.38 toks/s, output: 187.77 toks/s]Processed prompts:  12%|█▏        | 25/204 [01:12<02:05,  1.43it/s, est. speed input: 58.38 toks/s, output: 195.42 toks/s]Processed prompts:  13%|█▎        | 26/204 [01:14<03:00,  1.01s/it, est. speed input: 59.31 toks/s, output: 200.61 toks/s]Processed prompts:  13%|█▎        | 27/204 [01:15<03:00,  1.02s/it, est. speed input: 62.29 toks/s, output: 207.73 toks/s]Processed prompts:  14%|█▎        | 28/204 [01:15<02:22,  1.23it/s, est. speed input: 62.94 toks/s, output: 216.75 toks/s]Processed prompts:  14%|█▍        | 29/204 [01:16<02:20,  1.25it/s, est. speed input: 64.00 toks/s, output: 224.44 toks/s]Processed prompts:  15%|█▍        | 30/204 [01:16<02:07,  1.37it/s, est. speed input: 67.72 toks/s, output: 232.72 toks/s]Processed prompts:  15%|█▌        | 31/204 [01:17<02:15,  1.27it/s, est. speed input: 70.87 toks/s, output: 239.95 toks/s]Processed prompts:  16%|█▌        | 32/204 [01:18<02:27,  1.16it/s, est. speed input: 72.91 toks/s, output: 245.15 toks/s]Processed prompts:  16%|█▌        | 33/204 [01:18<01:52,  1.52it/s, est. speed input: 76.46 toks/s, output: 254.59 toks/s]Processed prompts:  17%|█▋        | 34/204 [01:19<02:02,  1.38it/s, est. speed input: 78.93 toks/s, output: 261.87 toks/s]Processed prompts:  18%|█▊        | 36/204 [01:21<02:01,  1.38it/s, est. speed input: 85.82 toks/s, output: 277.14 toks/s]Processed prompts:  18%|█▊        | 37/204 [01:22<02:39,  1.05it/s, est. speed input: 85.91 toks/s, output: 281.80 toks/s]Processed prompts:  19%|█▊        | 38/204 [01:23<02:33,  1.08it/s, est. speed input: 86.84 toks/s, output: 289.17 toks/s]Processed prompts:  19%|█▉        | 39/204 [01:23<02:01,  1.36it/s, est. speed input: 89.71 toks/s, output: 298.53 toks/s]Processed prompts:  20%|█▉        | 40/204 [01:25<02:39,  1.03it/s, est. speed input: 90.63 toks/s, output: 303.24 toks/s]Processed prompts:  20%|██        | 41/204 [01:26<03:00,  1.11s/it, est. speed input: 91.52 toks/s, output: 308.46 toks/s]Processed prompts:  21%|██        | 42/204 [01:28<02:58,  1.10s/it, est. speed input: 92.12 toks/s, output: 315.01 toks/s]Processed prompts:  21%|██        | 43/204 [01:28<02:20,  1.15it/s, est. speed input: 93.67 toks/s, output: 324.23 toks/s]Processed prompts:  22%|██▏       | 44/204 [01:29<02:08,  1.24it/s, est. speed input: 95.00 toks/s, output: 331.54 toks/s]Processed prompts:  22%|██▏       | 45/204 [01:29<02:10,  1.21it/s, est. speed input: 95.63 toks/s, output: 338.67 toks/s]Processed prompts:  23%|██▎       | 46/204 [01:30<01:59,  1.32it/s, est. speed input: 96.90 toks/s, output: 346.73 toks/s]Processed prompts:  23%|██▎       | 47/204 [01:30<01:43,  1.52it/s, est. speed input: 100.00 toks/s, output: 355.46 toks/s]Processed prompts:  24%|██▍       | 49/204 [01:31<01:29,  1.73it/s, est. speed input: 102.70 toks/s, output: 372.27 toks/s]Processed prompts:  25%|██▍       | 50/204 [01:33<02:08,  1.19it/s, est. speed input: 104.27 toks/s, output: 376.17 toks/s]Processed prompts:  25%|██▌       | 51/204 [01:33<01:46,  1.43it/s, est. speed input: 108.24 toks/s, output: 384.26 toks/s]Processed prompts:  25%|██▌       | 52/204 [01:36<03:04,  1.21s/it, est. speed input: 107.04 toks/s, output: 384.33 toks/s]Processed prompts:  26%|██▌       | 53/204 [01:36<02:33,  1.02s/it, est. speed input: 108.91 toks/s, output: 392.73 toks/s]Processed prompts:  26%|██▋       | 54/204 [01:37<02:19,  1.07it/s, est. speed input: 110.47 toks/s, output: 400.28 toks/s]Processed prompts:  27%|██▋       | 55/204 [01:40<03:41,  1.49s/it, est. speed input: 109.44 toks/s, output: 399.46 toks/s]Processed prompts:  28%|██▊       | 57/204 [01:42<03:00,  1.23s/it, est. speed input: 110.51 toks/s, output: 407.50 toks/s]Processed prompts:  28%|██▊       | 58/204 [01:42<02:39,  1.09s/it, est. speed input: 112.68 toks/s, output: 415.34 toks/s]Processed prompts:  29%|██▉       | 59/204 [01:43<02:11,  1.10it/s, est. speed input: 114.86 toks/s, output: 424.39 toks/s]Processed prompts:  29%|██▉       | 60/204 [01:43<01:46,  1.35it/s, est. speed input: 117.74 toks/s, output: 433.70 toks/s]Processed prompts:  30%|██▉       | 61/204 [01:44<02:01,  1.18it/s, est. speed input: 119.09 toks/s, output: 439.51 toks/s]Processed prompts:  30%|███       | 62/204 [01:47<02:58,  1.26s/it, est. speed input: 118.71 toks/s, output: 440.68 toks/s]Processed prompts:  31%|███       | 63/204 [01:47<02:32,  1.08s/it, est. speed input: 120.33 toks/s, output: 443.16 toks/s]Processed prompts:  31%|███▏      | 64/204 [01:48<02:12,  1.06it/s, est. speed input: 122.70 toks/s, output: 451.17 toks/s]Processed prompts:  32%|███▏      | 65/204 [01:49<02:05,  1.11it/s, est. speed input: 125.66 toks/s, output: 458.38 toks/s]Processed prompts:  32%|███▏      | 66/204 [01:49<01:46,  1.30it/s, est. speed input: 127.07 toks/s, output: 464.52 toks/s]Processed prompts:  33%|███▎      | 67/204 [01:49<01:30,  1.52it/s, est. speed input: 128.44 toks/s, output: 473.37 toks/s]Processed prompts:  33%|███▎      | 68/204 [01:51<01:46,  1.28it/s, est. speed input: 129.03 toks/s, output: 479.26 toks/s]Processed prompts:  34%|███▍      | 69/204 [01:53<02:37,  1.16s/it, est. speed input: 128.56 toks/s, output: 481.10 toks/s]Processed prompts:  34%|███▍      | 70/204 [01:53<02:06,  1.06it/s, est. speed input: 129.97 toks/s, output: 489.83 toks/s]Processed prompts:  35%|███▍      | 71/204 [01:54<01:50,  1.21it/s, est. speed input: 132.49 toks/s, output: 494.31 toks/s]Processed prompts:  35%|███▌      | 72/204 [01:55<02:10,  1.01it/s, est. speed input: 131.86 toks/s, output: 498.98 toks/s]Processed prompts:  36%|███▌      | 73/204 [01:55<01:50,  1.18it/s, est. speed input: 134.64 toks/s, output: 507.35 toks/s]Processed prompts:  36%|███▋      | 74/204 [01:56<01:44,  1.24it/s, est. speed input: 135.99 toks/s, output: 514.76 toks/s]Processed prompts:  37%|███▋      | 75/204 [01:57<01:58,  1.09it/s, est. speed input: 136.12 toks/s, output: 515.41 toks/s]Processed prompts:  37%|███▋      | 76/204 [01:58<01:39,  1.28it/s, est. speed input: 136.50 toks/s, output: 516.58 toks/s]Processed prompts:  38%|███▊      | 77/204 [01:59<01:46,  1.19it/s, est. speed input: 137.32 toks/s, output: 522.84 toks/s]Processed prompts:  38%|███▊      | 78/204 [01:59<01:25,  1.48it/s, est. speed input: 137.68 toks/s, output: 527.15 toks/s]Processed prompts:  39%|███▊      | 79/204 [02:00<01:45,  1.19it/s, est. speed input: 137.43 toks/s, output: 532.31 toks/s]Processed prompts:  39%|███▉      | 80/204 [02:02<02:29,  1.20s/it, est. speed input: 136.42 toks/s, output: 534.03 toks/s]Processed prompts:  40%|███▉      | 81/204 [02:04<02:33,  1.25s/it, est. speed input: 136.04 toks/s, output: 534.21 toks/s]Processed prompts:  40%|████      | 82/204 [02:04<02:10,  1.07s/it, est. speed input: 136.02 toks/s, output: 537.91 toks/s]Processed prompts:  41%|████      | 83/204 [02:05<01:58,  1.03it/s, est. speed input: 140.21 toks/s, output: 542.58 toks/s]Processed prompts:  41%|████      | 84/204 [02:06<02:10,  1.09s/it, est. speed input: 140.31 toks/s, output: 547.42 toks/s]Processed prompts:  42%|████▏     | 85/204 [02:10<03:23,  1.71s/it, est. speed input: 138.11 toks/s, output: 538.84 toks/s]Processed prompts:  42%|████▏     | 86/204 [02:10<02:46,  1.41s/it, est. speed input: 138.12 toks/s, output: 546.64 toks/s]WARNING 01-28 01:19:41 scheduler.py:1558] Sequence group 725 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=401
Processed prompts:  43%|████▎     | 87/204 [02:14<04:00,  2.05s/it, est. speed input: 136.83 toks/s, output: 543.07 toks/s]Processed prompts:  43%|████▎     | 88/204 [02:15<03:25,  1.77s/it, est. speed input: 137.83 toks/s, output: 549.40 toks/s]Processed prompts:  44%|████▎     | 89/204 [02:16<03:07,  1.63s/it, est. speed input: 138.90 toks/s, output: 550.37 toks/s]Processed prompts:  44%|████▍     | 90/204 [02:18<03:23,  1.78s/it, est. speed input: 138.13 toks/s, output: 551.33 toks/s]Processed prompts:  45%|████▍     | 91/204 [02:19<02:30,  1.33s/it, est. speed input: 139.99 toks/s, output: 553.89 toks/s]Processed prompts:  45%|████▌     | 92/204 [02:20<02:27,  1.32s/it, est. speed input: 139.82 toks/s, output: 552.05 toks/s]Processed prompts:  46%|████▌     | 94/204 [02:21<01:32,  1.19it/s, est. speed input: 141.21 toks/s, output: 563.42 toks/s]Processed prompts:  47%|████▋     | 95/204 [02:21<01:26,  1.26it/s, est. speed input: 141.41 toks/s, output: 565.25 toks/s]Processed prompts:  48%|████▊     | 97/204 [02:24<01:51,  1.04s/it, est. speed input: 142.59 toks/s, output: 568.90 toks/s]Processed prompts:  48%|████▊     | 98/204 [02:27<02:39,  1.50s/it, est. speed input: 140.68 toks/s, output: 560.81 toks/s]Processed prompts:  49%|████▊     | 99/204 [02:27<02:03,  1.18s/it, est. speed input: 142.00 toks/s, output: 567.27 toks/s]Processed prompts:  50%|████▉     | 101/204 [02:29<01:49,  1.06s/it, est. speed input: 144.39 toks/s, output: 576.83 toks/s]Processed prompts:  50%|█████     | 102/204 [02:29<01:33,  1.10it/s, est. speed input: 145.71 toks/s, output: 583.84 toks/s]Processed prompts:  50%|█████     | 103/204 [02:31<01:45,  1.04s/it, est. speed input: 145.92 toks/s, output: 586.29 toks/s]Processed prompts:  51%|█████     | 104/204 [02:31<01:24,  1.18it/s, est. speed input: 146.40 toks/s, output: 588.11 toks/s]Processed prompts:  51%|█████▏    | 105/204 [02:32<01:12,  1.37it/s, est. speed input: 146.96 toks/s, output: 592.63 toks/s]Processed prompts:  52%|█████▏    | 106/204 [02:32<01:00,  1.61it/s, est. speed input: 147.33 toks/s, output: 595.80 toks/s]Processed prompts:  52%|█████▏    | 107/204 [02:33<01:07,  1.43it/s, est. speed input: 147.52 toks/s, output: 596.36 toks/s]Processed prompts:  53%|█████▎    | 108/204 [02:34<01:05,  1.46it/s, est. speed input: 147.67 toks/s, output: 597.62 toks/s]Processed prompts:  53%|█████▎    | 109/204 [02:34<00:49,  1.93it/s, est. speed input: 149.56 toks/s, output: 601.80 toks/s]Processed prompts:  54%|█████▍    | 110/204 [02:34<00:42,  2.21it/s, est. speed input: 150.74 toks/s, output: 605.24 toks/s]Processed prompts:  54%|█████▍    | 111/204 [02:34<00:38,  2.41it/s, est. speed input: 151.75 toks/s, output: 609.08 toks/s]Processed prompts:  55%|█████▍    | 112/204 [02:36<01:02,  1.47it/s, est. speed input: 152.47 toks/s, output: 614.90 toks/s]Processed prompts:  55%|█████▌    | 113/204 [02:36<01:02,  1.47it/s, est. speed input: 153.08 toks/s, output: 618.85 toks/s]Processed prompts:  56%|█████▌    | 114/204 [02:37<00:59,  1.50it/s, est. speed input: 153.35 toks/s, output: 627.27 toks/s]Processed prompts:  56%|█████▋    | 115/204 [02:38<01:02,  1.41it/s, est. speed input: 154.83 toks/s, output: 631.71 toks/s]Processed prompts:  57%|█████▋    | 116/204 [02:39<01:31,  1.04s/it, est. speed input: 155.01 toks/s, output: 635.34 toks/s]Processed prompts:  57%|█████▋    | 117/204 [02:41<01:47,  1.23s/it, est. speed input: 154.55 toks/s, output: 639.60 toks/s]Processed prompts:  58%|█████▊    | 118/204 [02:42<01:30,  1.06s/it, est. speed input: 154.75 toks/s, output: 642.24 toks/s]Processed prompts:  58%|█████▊    | 119/204 [02:45<02:21,  1.67s/it, est. speed input: 152.91 toks/s, output: 635.58 toks/s]Processed prompts:  59%|█████▉    | 120/204 [02:45<01:44,  1.25s/it, est. speed input: 153.51 toks/s, output: 639.19 toks/s]Processed prompts:  59%|█████▉    | 121/204 [02:46<01:23,  1.00s/it, est. speed input: 153.90 toks/s, output: 648.28 toks/s]Processed prompts:  60%|█████▉    | 122/204 [02:46<01:19,  1.03it/s, est. speed input: 154.66 toks/s, output: 647.13 toks/s]Processed prompts:  60%|██████    | 123/204 [02:47<01:00,  1.35it/s, est. speed input: 155.35 toks/s, output: 652.44 toks/s]Processed prompts:  61%|██████▏   | 125/204 [02:48<00:47,  1.65it/s, est. speed input: 156.93 toks/s, output: 664.92 toks/s]Processed prompts:  62%|██████▏   | 126/204 [02:48<00:42,  1.84it/s, est. speed input: 158.84 toks/s, output: 673.46 toks/s]Processed prompts:  62%|██████▏   | 127/204 [02:50<01:10,  1.10it/s, est. speed input: 158.04 toks/s, output: 671.06 toks/s]Processed prompts:  63%|██████▎   | 128/204 [02:50<00:56,  1.35it/s, est. speed input: 160.15 toks/s, output: 675.03 toks/s]Processed prompts:  63%|██████▎   | 129/204 [02:52<01:12,  1.04it/s, est. speed input: 160.56 toks/s, output: 675.36 toks/s]Processed prompts:  64%|██████▎   | 130/204 [02:56<02:22,  1.93s/it, est. speed input: 157.29 toks/s, output: 663.91 toks/s]Processed prompts:  64%|██████▍   | 131/204 [02:57<01:54,  1.57s/it, est. speed input: 159.20 toks/s, output: 667.85 toks/s]Processed prompts:  65%|██████▍   | 132/204 [02:57<01:33,  1.29s/it, est. speed input: 159.53 toks/s, output: 668.76 toks/s]Processed prompts:  65%|██████▌   | 133/204 [02:58<01:12,  1.01s/it, est. speed input: 161.50 toks/s, output: 670.90 toks/s]Processed prompts:  66%|██████▌   | 134/204 [02:59<01:25,  1.23s/it, est. speed input: 162.62 toks/s, output: 672.53 toks/s]Processed prompts:  66%|██████▌   | 135/204 [03:00<01:10,  1.02s/it, est. speed input: 162.70 toks/s, output: 677.25 toks/s]Processed prompts:  67%|██████▋   | 136/204 [03:02<01:20,  1.19s/it, est. speed input: 162.04 toks/s, output: 676.83 toks/s]Processed prompts:  67%|██████▋   | 137/204 [03:02<00:59,  1.12it/s, est. speed input: 163.53 toks/s, output: 685.42 toks/s]Processed prompts:  68%|██████▊   | 138/204 [03:02<00:52,  1.27it/s, est. speed input: 163.63 toks/s, output: 685.92 toks/s]Processed prompts:  68%|██████▊   | 139/204 [03:03<00:48,  1.33it/s, est. speed input: 164.20 toks/s, output: 686.38 toks/s]Processed prompts:  69%|██████▊   | 140/204 [03:04<00:44,  1.45it/s, est. speed input: 164.95 toks/s, output: 690.65 toks/s]Processed prompts:  69%|██████▉   | 141/204 [03:05<00:51,  1.21it/s, est. speed input: 164.46 toks/s, output: 690.50 toks/s]Processed prompts:  70%|██████▉   | 142/204 [03:05<00:46,  1.34it/s, est. speed input: 164.72 toks/s, output: 694.08 toks/s]Processed prompts:  70%|███████   | 143/204 [03:05<00:35,  1.72it/s, est. speed input: 165.31 toks/s, output: 696.98 toks/s]Processed prompts:  71%|███████   | 145/204 [03:06<00:20,  2.81it/s, est. speed input: 166.31 toks/s, output: 702.28 toks/s]Processed prompts:  72%|███████▏  | 146/204 [03:07<00:37,  1.53it/s, est. speed input: 165.84 toks/s, output: 702.18 toks/s]Processed prompts:  72%|███████▏  | 147/204 [03:08<00:34,  1.63it/s, est. speed input: 166.61 toks/s, output: 703.62 toks/s]Processed prompts:  73%|███████▎  | 148/204 [03:10<01:01,  1.10s/it, est. speed input: 165.61 toks/s, output: 697.88 toks/s]Processed prompts:  73%|███████▎  | 149/204 [03:13<01:21,  1.49s/it, est. speed input: 165.43 toks/s, output: 696.20 toks/s]Processed prompts:  74%|███████▎  | 150/204 [03:13<00:59,  1.10s/it, est. speed input: 166.58 toks/s, output: 699.52 toks/s]Processed prompts:  74%|███████▍  | 151/204 [03:14<00:54,  1.03s/it, est. speed input: 166.76 toks/s, output: 700.40 toks/s]Processed prompts:  75%|███████▍  | 152/204 [03:15<00:55,  1.06s/it, est. speed input: 167.08 toks/s, output: 703.01 toks/s]Processed prompts:  75%|███████▌  | 153/204 [03:16<00:52,  1.04s/it, est. speed input: 167.07 toks/s, output: 702.77 toks/s]Processed prompts:  75%|███████▌  | 154/204 [03:18<01:05,  1.30s/it, est. speed input: 165.91 toks/s, output: 699.67 toks/s]Processed prompts:  76%|███████▋  | 156/204 [03:18<00:40,  1.19it/s, est. speed input: 167.30 toks/s, output: 708.58 toks/s]Processed prompts:  77%|███████▋  | 157/204 [03:19<00:40,  1.17it/s, est. speed input: 167.06 toks/s, output: 708.17 toks/s]Processed prompts:  77%|███████▋  | 158/204 [03:20<00:36,  1.28it/s, est. speed input: 167.19 toks/s, output: 710.15 toks/s]Processed prompts:  78%|███████▊  | 159/204 [03:20<00:29,  1.50it/s, est. speed input: 167.93 toks/s, output: 712.96 toks/s]Processed prompts:  78%|███████▊  | 160/204 [03:21<00:31,  1.39it/s, est. speed input: 168.74 toks/s, output: 717.26 toks/s]Processed prompts:  79%|███████▉  | 162/204 [03:21<00:19,  2.15it/s, est. speed input: 170.71 toks/s, output: 723.43 toks/s]Processed prompts:  80%|███████▉  | 163/204 [03:22<00:18,  2.23it/s, est. speed input: 171.67 toks/s, output: 730.07 toks/s]Processed prompts:  80%|████████  | 164/204 [03:22<00:20,  1.99it/s, est. speed input: 172.14 toks/s, output: 731.86 toks/s]Processed prompts:  81%|████████  | 165/204 [03:24<00:28,  1.36it/s, est. speed input: 172.04 toks/s, output: 731.08 toks/s]Processed prompts:  81%|████████▏ | 166/204 [03:24<00:29,  1.30it/s, est. speed input: 171.88 toks/s, output: 731.43 toks/s]Processed prompts:  82%|████████▏ | 167/204 [03:25<00:23,  1.59it/s, est. speed input: 172.90 toks/s, output: 739.21 toks/s]Processed prompts:  82%|████████▏ | 168/204 [03:25<00:22,  1.59it/s, est. speed input: 173.73 toks/s, output: 744.36 toks/s]Processed prompts:  83%|████████▎ | 169/204 [03:26<00:17,  1.97it/s, est. speed input: 174.35 toks/s, output: 746.83 toks/s]Processed prompts:  83%|████████▎ | 170/204 [03:27<00:27,  1.22it/s, est. speed input: 174.44 toks/s, output: 746.39 toks/s]Processed prompts:  84%|████████▍ | 171/204 [03:27<00:21,  1.53it/s, est. speed input: 177.18 toks/s, output: 749.68 toks/s]Processed prompts:  85%|████████▍ | 173/204 [03:28<00:14,  2.19it/s, est. speed input: 178.76 toks/s, output: 757.15 toks/s]Processed prompts:  86%|████████▌ | 175/204 [03:30<00:18,  1.61it/s, est. speed input: 178.87 toks/s, output: 763.59 toks/s]Processed prompts:  86%|████████▋ | 176/204 [03:30<00:14,  1.93it/s, est. speed input: 179.08 toks/s, output: 766.70 toks/s]Processed prompts:  87%|████████▋ | 177/204 [03:32<00:22,  1.21it/s, est. speed input: 179.11 toks/s, output: 764.88 toks/s]Processed prompts:  88%|████████▊ | 180/204 [03:32<00:11,  2.06it/s, est. speed input: 181.97 toks/s, output: 777.26 toks/s]Processed prompts:  89%|████████▊ | 181/204 [03:32<00:10,  2.30it/s, est. speed input: 182.32 toks/s, output: 780.83 toks/s]Processed prompts:  89%|████████▉ | 182/204 [03:33<00:11,  1.94it/s, est. speed input: 182.83 toks/s, output: 783.45 toks/s]Processed prompts:  90%|████████▉ | 183/204 [03:35<00:16,  1.29it/s, est. speed input: 182.68 toks/s, output: 781.98 toks/s]Processed prompts:  90%|█████████ | 184/204 [03:35<00:14,  1.34it/s, est. speed input: 183.33 toks/s, output: 784.52 toks/s]Processed prompts:  91%|█████████ | 185/204 [03:36<00:16,  1.17it/s, est. speed input: 183.95 toks/s, output: 784.68 toks/s]Processed prompts:  91%|█████████ | 186/204 [03:42<00:37,  2.11s/it, est. speed input: 180.37 toks/s, output: 772.89 toks/s]Processed prompts:  92%|█████████▏| 188/204 [03:45<00:29,  1.86s/it, est. speed input: 179.00 toks/s, output: 772.53 toks/s]Processed prompts:  93%|█████████▎| 189/204 [03:48<00:30,  2.03s/it, est. speed input: 178.05 toks/s, output: 769.09 toks/s]Processed prompts:  93%|█████████▎| 190/204 [03:48<00:23,  1.65s/it, est. speed input: 179.83 toks/s, output: 772.51 toks/s]Processed prompts:  94%|█████████▎| 191/204 [03:49<00:20,  1.58s/it, est. speed input: 180.21 toks/s, output: 773.18 toks/s]Processed prompts:  94%|█████████▍| 192/204 [03:50<00:16,  1.37s/it, est. speed input: 180.44 toks/s, output: 776.24 toks/s]Processed prompts:  95%|█████████▍| 193/204 [03:53<00:18,  1.68s/it, est. speed input: 179.26 toks/s, output: 774.47 toks/s]Processed prompts:  95%|█████████▌| 194/204 [03:55<00:18,  1.87s/it, est. speed input: 178.28 toks/s, output: 773.21 toks/s]Processed prompts:  96%|█████████▌| 195/204 [03:57<00:16,  1.81s/it, est. speed input: 177.67 toks/s, output: 774.23 toks/s]Processed prompts:  96%|█████████▌| 196/204 [03:58<00:13,  1.74s/it, est. speed input: 177.89 toks/s, output: 775.52 toks/s]Processed prompts:  97%|█████████▋| 197/204 [04:00<00:12,  1.72s/it, est. speed input: 178.39 toks/s, output: 776.82 toks/s]Processed prompts:  98%|█████████▊| 199/204 [04:01<00:05,  1.06s/it, est. speed input: 180.43 toks/s, output: 787.98 toks/s]Processed prompts:  98%|█████████▊| 200/204 [04:01<00:03,  1.03it/s, est. speed input: 181.42 toks/s, output: 792.71 toks/s]Processed prompts:  99%|█████████▊| 201/204 [04:02<00:02,  1.17it/s, est. speed input: 182.58 toks/s, output: 797.85 toks/s]Processed prompts:  99%|█████████▉| 202/204 [04:02<00:01,  1.37it/s, est. speed input: 183.89 toks/s, output: 803.38 toks/s]Processed prompts: 100%|█████████▉| 203/204 [04:04<00:00,  1.03it/s, est. speed input: 183.83 toks/s, output: 805.35 toks/s]Processed prompts: 100%|██████████| 204/204 [04:07<00:00,  1.52s/it, est. speed input: 182.21 toks/s, output: 803.76 toks/s]Processed prompts: 100%|██████████| 204/204 [04:07<00:00,  1.21s/it, est. speed input: 182.21 toks/s, output: 803.76 toks/s]
Results for dataset quantum_dataset_textonly saved to project/Kaiyue/offline_outputs/CohereForAI_c4ai-command-r-v01/quantum_dataset_textonly/response.jsonl.
Processing dataset: project/Kaiyue/datasets/statistics_dataset_textonly.jsonl
Processing statistics_dataset_textonly:   0%|          | 0/212 [00:00<?, ?it/s]Processing statistics_dataset_textonly: 100%|██████████| 212/212 [00:00<00:00, 599994.90it/s]
Processed prompts:   0%|          | 0/212 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   0%|          | 1/212 [00:20<1:11:24, 20.31s/it, est. speed input: 6.11 toks/s, output: 3.99 toks/s]WARNING 01-28 01:21:57 scheduler.py:1558] Sequence group 981 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=451
Processed prompts:   1%|          | 2/212 [00:28<45:21, 12.96s/it, est. speed input: 7.43 toks/s, output: 8.28 toks/s]  WARNING 01-28 01:22:08 scheduler.py:1558] Sequence group 931 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=501
Processed prompts:   1%|▏         | 3/212 [00:37<39:30, 11.34s/it, est. speed input: 11.40 toks/s, output: 12.73 toks/s]Processed prompts:   2%|▏         | 4/212 [00:39<26:27,  7.63s/it, est. speed input: 13.12 toks/s, output: 18.87 toks/s]Processed prompts:   2%|▏         | 5/212 [00:41<19:09,  5.55s/it, est. speed input: 14.53 toks/s, output: 25.03 toks/s]Processed prompts:   3%|▎         | 6/212 [00:42<14:08,  4.12s/it, est. speed input: 17.75 toks/s, output: 31.34 toks/s]Processed prompts:   3%|▎         | 7/212 [00:44<11:04,  3.24s/it, est. speed input: 19.90 toks/s, output: 37.60 toks/s]Processed prompts:   4%|▍         | 8/212 [00:45<08:31,  2.51s/it, est. speed input: 21.91 toks/s, output: 44.22 toks/s]Processed prompts:   4%|▍         | 9/212 [00:47<08:35,  2.54s/it, est. speed input: 24.40 toks/s, output: 49.49 toks/s]Processed prompts:   5%|▍         | 10/212 [00:48<06:18,  1.87s/it, est. speed input: 27.51 toks/s, output: 56.84 toks/s]Processed prompts:   6%|▌         | 12/212 [00:48<03:26,  1.03s/it, est. speed input: 31.87 toks/s, output: 72.16 toks/s]Processed prompts:   6%|▌         | 13/212 [00:48<02:42,  1.23it/s, est. speed input: 33.72 toks/s, output: 79.66 toks/s]Processed prompts:   7%|▋         | 14/212 [00:48<02:27,  1.34it/s, est. speed input: 35.71 toks/s, output: 86.50 toks/s]Processed prompts:   7%|▋         | 15/212 [00:49<01:54,  1.72it/s, est. speed input: 38.09 toks/s, output: 94.00 toks/s]Processed prompts:   8%|▊         | 16/212 [00:49<01:59,  1.64it/s, est. speed input: 40.40 toks/s, output: 100.56 toks/s]Processed prompts:   8%|▊         | 17/212 [00:50<02:31,  1.28it/s, est. speed input: 44.92 toks/s, output: 106.15 toks/s]Processed prompts:   9%|▉         | 19/212 [00:53<03:00,  1.07it/s, est. speed input: 46.67 toks/s, output: 117.47 toks/s]Processed prompts:   9%|▉         | 20/212 [00:53<02:46,  1.15it/s, est. speed input: 48.01 toks/s, output: 124.25 toks/s]Processed prompts:  10%|▉         | 21/212 [00:54<02:24,  1.32it/s, est. speed input: 49.31 toks/s, output: 131.51 toks/s]Processed prompts:  10%|█         | 22/212 [00:54<01:52,  1.69it/s, est. speed input: 51.07 toks/s, output: 139.44 toks/s]Processed prompts:  11%|█         | 23/212 [00:56<03:12,  1.02s/it, est. speed input: 52.15 toks/s, output: 142.65 toks/s]Processed prompts:  11%|█▏        | 24/212 [00:57<02:47,  1.12it/s, est. speed input: 53.62 toks/s, output: 149.70 toks/s]Processed prompts:  12%|█▏        | 25/212 [00:59<04:07,  1.32s/it, est. speed input: 53.46 toks/s, output: 152.40 toks/s]Processed prompts:  12%|█▏        | 26/212 [00:59<03:05,  1.00it/s, est. speed input: 57.71 toks/s, output: 160.58 toks/s]Processed prompts:  13%|█▎        | 27/212 [01:00<03:00,  1.03it/s, est. speed input: 59.74 toks/s, output: 166.92 toks/s]Processed prompts:  13%|█▎        | 28/212 [01:01<02:51,  1.07it/s, est. speed input: 60.91 toks/s, output: 173.42 toks/s]Processed prompts:  14%|█▍        | 30/212 [01:02<01:55,  1.58it/s, est. speed input: 64.54 toks/s, output: 189.37 toks/s]Processed prompts:  15%|█▍        | 31/212 [01:02<01:44,  1.73it/s, est. speed input: 66.52 toks/s, output: 196.91 toks/s]Processed prompts:  15%|█▌        | 32/212 [01:02<01:26,  2.07it/s, est. speed input: 68.61 toks/s, output: 205.04 toks/s]Processed prompts:  16%|█▌        | 33/212 [01:03<01:45,  1.70it/s, est. speed input: 69.07 toks/s, output: 211.04 toks/s]Processed prompts:  16%|█▌        | 34/212 [01:03<01:36,  1.85it/s, est. speed input: 71.03 toks/s, output: 218.50 toks/s]Processed prompts:  17%|█▋        | 35/212 [01:04<01:40,  1.77it/s, est. speed input: 71.65 toks/s, output: 225.27 toks/s]Processed prompts:  17%|█▋        | 37/212 [01:05<01:27,  2.01it/s, est. speed input: 74.22 toks/s, output: 240.14 toks/s]Processed prompts:  18%|█▊        | 38/212 [01:05<01:26,  2.02it/s, est. speed input: 75.58 toks/s, output: 247.35 toks/s]Processed prompts:  18%|█▊        | 39/212 [01:07<02:04,  1.39it/s, est. speed input: 76.61 toks/s, output: 251.37 toks/s]Processed prompts:  19%|█▉        | 41/212 [01:08<02:10,  1.31it/s, est. speed input: 78.08 toks/s, output: 263.33 toks/s]Processed prompts:  20%|█▉        | 42/212 [01:09<01:50,  1.54it/s, est. speed input: 80.78 toks/s, output: 271.43 toks/s]Processed prompts:  20%|██        | 43/212 [01:09<01:39,  1.70it/s, est. speed input: 83.69 toks/s, output: 279.01 toks/s]Processed prompts:  21%|██        | 44/212 [01:09<01:20,  2.09it/s, est. speed input: 87.11 toks/s, output: 287.46 toks/s]Processed prompts:  21%|██        | 45/212 [01:11<02:20,  1.19it/s, est. speed input: 85.86 toks/s, output: 289.40 toks/s]Processed prompts:  22%|██▏       | 46/212 [01:12<02:31,  1.10it/s, est. speed input: 86.05 toks/s, output: 294.32 toks/s]Processed prompts:  22%|██▏       | 47/212 [01:13<02:06,  1.30it/s, est. speed input: 89.44 toks/s, output: 301.99 toks/s]Processed prompts:  23%|██▎       | 48/212 [01:14<02:15,  1.21it/s, est. speed input: 91.81 toks/s, output: 305.99 toks/s]Processed prompts:  23%|██▎       | 49/212 [01:14<02:15,  1.20it/s, est. speed input: 94.24 toks/s, output: 312.01 toks/s]Processed prompts:  24%|██▎       | 50/212 [01:15<02:05,  1.29it/s, est. speed input: 95.79 toks/s, output: 318.88 toks/s]Processed prompts:  24%|██▍       | 51/212 [01:15<01:39,  1.61it/s, est. speed input: 98.21 toks/s, output: 327.28 toks/s]Processed prompts:  25%|██▍       | 52/212 [01:16<01:25,  1.88it/s, est. speed input: 101.45 toks/s, output: 335.34 toks/s]Processed prompts:  25%|██▌       | 53/212 [01:17<01:52,  1.42it/s, est. speed input: 101.49 toks/s, output: 340.00 toks/s]Processed prompts:  25%|██▌       | 54/212 [01:17<01:27,  1.80it/s, est. speed input: 102.57 toks/s, output: 348.58 toks/s]Processed prompts:  26%|██▌       | 55/212 [01:17<01:22,  1.90it/s, est. speed input: 103.29 toks/s, output: 356.02 toks/s]Processed prompts:  26%|██▋       | 56/212 [01:18<01:23,  1.88it/s, est. speed input: 105.82 toks/s, output: 362.98 toks/s]Processed prompts:  27%|██▋       | 57/212 [01:18<01:22,  1.89it/s, est. speed input: 107.24 toks/s, output: 370.04 toks/s]Processed prompts:  27%|██▋       | 58/212 [01:19<01:15,  2.03it/s, est. speed input: 108.83 toks/s, output: 377.63 toks/s]Processed prompts:  28%|██▊       | 59/212 [01:19<01:16,  2.00it/s, est. speed input: 109.56 toks/s, output: 384.64 toks/s]Processed prompts:  28%|██▊       | 60/212 [01:20<00:59,  2.55it/s, est. speed input: 111.27 toks/s, output: 393.42 toks/s]Processed prompts:  29%|██▉       | 61/212 [01:20<01:02,  2.43it/s, est. speed input: 113.83 toks/s, output: 400.63 toks/s]Processed prompts:  29%|██▉       | 62/212 [01:20<01:01,  2.45it/s, est. speed input: 115.29 toks/s, output: 408.06 toks/s]Processed prompts:  30%|██▉       | 63/212 [01:21<00:59,  2.51it/s, est. speed input: 116.21 toks/s, output: 415.58 toks/s]Processed prompts:  30%|███       | 64/212 [01:21<01:06,  2.21it/s, est. speed input: 116.89 toks/s, output: 422.05 toks/s]WARNING 01-28 01:22:57 scheduler.py:1558] Sequence group 916 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=551
Processed prompts:  31%|███       | 65/212 [01:23<01:52,  1.30it/s, est. speed input: 117.29 toks/s, output: 420.05 toks/s]Processed prompts:  31%|███       | 66/212 [01:23<01:27,  1.68it/s, est. speed input: 118.18 toks/s, output: 428.55 toks/s]Processed prompts:  32%|███▏      | 67/212 [01:24<01:29,  1.63it/s, est. speed input: 119.86 toks/s, output: 434.54 toks/s]Processed prompts:  32%|███▏      | 68/212 [01:24<01:35,  1.51it/s, est. speed input: 120.79 toks/s, output: 440.08 toks/s]Processed prompts:  33%|███▎      | 69/212 [01:25<01:17,  1.84it/s, est. speed input: 123.37 toks/s, output: 448.25 toks/s]Processed prompts:  33%|███▎      | 70/212 [01:26<01:29,  1.58it/s, est. speed input: 123.57 toks/s, output: 453.38 toks/s]Processed prompts:  33%|███▎      | 71/212 [01:26<01:25,  1.65it/s, est. speed input: 124.57 toks/s, output: 460.08 toks/s]Processed prompts:  34%|███▍      | 72/212 [01:27<01:44,  1.33it/s, est. speed input: 125.14 toks/s, output: 463.93 toks/s]Processed prompts:  34%|███▍      | 73/212 [01:28<01:32,  1.50it/s, est. speed input: 127.38 toks/s, output: 471.02 toks/s]Processed prompts:  35%|███▍      | 74/212 [01:29<01:39,  1.39it/s, est. speed input: 128.84 toks/s, output: 476.07 toks/s]Processed prompts:  35%|███▌      | 75/212 [01:29<01:33,  1.47it/s, est. speed input: 131.66 toks/s, output: 482.53 toks/s]Processed prompts:  36%|███▋      | 77/212 [01:30<01:12,  1.85it/s, est. speed input: 134.13 toks/s, output: 497.08 toks/s]Processed prompts:  37%|███▋      | 78/212 [01:30<01:15,  1.77it/s, est. speed input: 136.47 toks/s, output: 503.11 toks/s]Processed prompts:  37%|███▋      | 79/212 [01:31<01:27,  1.51it/s, est. speed input: 139.36 toks/s, output: 504.64 toks/s]Processed prompts:  38%|███▊      | 80/212 [01:32<01:24,  1.57it/s, est. speed input: 140.05 toks/s, output: 511.05 toks/s]Processed prompts:  38%|███▊      | 81/212 [01:33<01:36,  1.35it/s, est. speed input: 140.92 toks/s, output: 515.19 toks/s]Processed prompts:  39%|███▊      | 82/212 [01:33<01:26,  1.51it/s, est. speed input: 142.19 toks/s, output: 522.19 toks/s]Processed prompts:  39%|███▉      | 83/212 [01:35<02:15,  1.05s/it, est. speed input: 143.97 toks/s, output: 520.99 toks/s]Processed prompts:  40%|███▉      | 84/212 [01:38<03:07,  1.47s/it, est. speed input: 143.72 toks/s, output: 517.64 toks/s]Processed prompts:  40%|████      | 85/212 [01:39<02:47,  1.32s/it, est. speed input: 143.54 toks/s, output: 522.41 toks/s]Processed prompts:  41%|████      | 86/212 [01:39<02:10,  1.04s/it, est. speed input: 144.12 toks/s, output: 525.30 toks/s]Processed prompts:  41%|████      | 87/212 [01:40<01:47,  1.16it/s, est. speed input: 145.01 toks/s, output: 532.70 toks/s]Processed prompts:  42%|████▏     | 88/212 [01:40<01:30,  1.38it/s, est. speed input: 145.89 toks/s, output: 538.26 toks/s]Processed prompts:  42%|████▏     | 89/212 [01:40<01:11,  1.73it/s, est. speed input: 150.06 toks/s, output: 546.80 toks/s]Processed prompts:  42%|████▏     | 90/212 [01:41<01:18,  1.55it/s, est. speed input: 151.15 toks/s, output: 552.22 toks/s]Processed prompts:  43%|████▎     | 91/212 [01:41<01:06,  1.81it/s, est. speed input: 153.44 toks/s, output: 560.12 toks/s]Processed prompts:  43%|████▎     | 92/212 [01:42<01:14,  1.61it/s, est. speed input: 153.53 toks/s, output: 561.41 toks/s]Processed prompts:  44%|████▍     | 94/212 [01:43<00:55,  2.14it/s, est. speed input: 155.58 toks/s, output: 566.15 toks/s]Processed prompts:  45%|████▍     | 95/212 [01:44<01:01,  1.90it/s, est. speed input: 155.51 toks/s, output: 566.58 toks/s]Processed prompts:  46%|████▌     | 97/212 [01:44<00:51,  2.25it/s, est. speed input: 159.46 toks/s, output: 582.38 toks/s]Processed prompts:  46%|████▌     | 98/212 [01:45<01:03,  1.79it/s, est. speed input: 159.85 toks/s, output: 586.86 toks/s]Processed prompts:  47%|████▋     | 99/212 [01:46<01:02,  1.81it/s, est. speed input: 160.68 toks/s, output: 593.66 toks/s]Processed prompts:  47%|████▋     | 100/212 [01:46<01:00,  1.85it/s, est. speed input: 161.73 toks/s, output: 600.50 toks/s]Processed prompts:  48%|████▊     | 101/212 [01:47<01:03,  1.76it/s, est. speed input: 162.16 toks/s, output: 606.59 toks/s]Processed prompts:  48%|████▊     | 102/212 [01:47<00:58,  1.87it/s, est. speed input: 162.53 toks/s, output: 609.32 toks/s]Processed prompts:  49%|████▊     | 103/212 [01:48<00:56,  1.94it/s, est. speed input: 162.66 toks/s, output: 608.80 toks/s]Processed prompts:  49%|████▉     | 104/212 [01:49<01:32,  1.16it/s, est. speed input: 161.44 toks/s, output: 609.10 toks/s]Processed prompts:  50%|████▉     | 105/212 [01:51<01:41,  1.06it/s, est. speed input: 161.73 toks/s, output: 612.54 toks/s]Processed prompts:  50%|█████     | 106/212 [01:51<01:29,  1.19it/s, est. speed input: 161.98 toks/s, output: 614.03 toks/s]Processed prompts:  50%|█████     | 107/212 [01:53<02:06,  1.20s/it, est. speed input: 160.25 toks/s, output: 607.05 toks/s]Processed prompts:  51%|█████     | 108/212 [01:54<01:36,  1.08it/s, est. speed input: 162.93 toks/s, output: 615.41 toks/s]Processed prompts:  51%|█████▏    | 109/212 [01:54<01:18,  1.31it/s, est. speed input: 163.76 toks/s, output: 616.26 toks/s]Processed prompts:  52%|█████▏    | 110/212 [01:55<01:16,  1.34it/s, est. speed input: 165.84 toks/s, output: 622.31 toks/s]Processed prompts:  52%|█████▏    | 111/212 [01:56<01:27,  1.15it/s, est. speed input: 165.58 toks/s, output: 620.25 toks/s]Processed prompts:  53%|█████▎    | 112/212 [01:56<01:13,  1.36it/s, est. speed input: 166.49 toks/s, output: 627.91 toks/s]Processed prompts:  53%|█████▎    | 113/212 [01:57<01:07,  1.46it/s, est. speed input: 167.06 toks/s, output: 630.77 toks/s]Processed prompts:  54%|█████▍    | 114/212 [01:58<01:21,  1.20it/s, est. speed input: 166.20 toks/s, output: 629.62 toks/s]Processed prompts:  55%|█████▍    | 116/212 [02:00<01:23,  1.16it/s, est. speed input: 167.53 toks/s, output: 636.06 toks/s]Processed prompts:  55%|█████▌    | 117/212 [02:02<01:52,  1.18s/it, est. speed input: 166.87 toks/s, output: 634.94 toks/s]Processed prompts:  56%|█████▌    | 118/212 [02:03<01:39,  1.06s/it, est. speed input: 167.22 toks/s, output: 641.23 toks/s]Processed prompts:  57%|█████▋    | 120/212 [02:04<01:26,  1.06it/s, est. speed input: 168.53 toks/s, output: 645.06 toks/s]Processed prompts:  57%|█████▋    | 121/212 [02:05<01:19,  1.14it/s, est. speed input: 168.87 toks/s, output: 646.67 toks/s]Processed prompts:  58%|█████▊    | 122/212 [02:06<01:35,  1.06s/it, est. speed input: 167.92 toks/s, output: 645.28 toks/s]Processed prompts:  58%|█████▊    | 123/212 [02:08<01:48,  1.22s/it, est. speed input: 167.15 toks/s, output: 642.86 toks/s]Processed prompts:  58%|█████▊    | 124/212 [02:08<01:23,  1.06it/s, est. speed input: 169.53 toks/s, output: 648.86 toks/s]Processed prompts:  59%|█████▉    | 125/212 [02:09<01:26,  1.01it/s, est. speed input: 169.57 toks/s, output: 653.33 toks/s]Processed prompts:  59%|█████▉    | 126/212 [02:10<01:23,  1.04it/s, est. speed input: 170.58 toks/s, output: 654.07 toks/s]Processed prompts:  60%|█████▉    | 127/212 [02:12<01:28,  1.04s/it, est. speed input: 171.11 toks/s, output: 653.29 toks/s]Processed prompts:  60%|██████    | 128/212 [02:12<01:16,  1.10it/s, est. speed input: 171.20 toks/s, output: 652.54 toks/s]Processed prompts:  61%|██████    | 129/212 [02:13<01:18,  1.05it/s, est. speed input: 171.12 toks/s, output: 653.91 toks/s]Processed prompts:  61%|██████▏   | 130/212 [02:14<01:09,  1.17it/s, est. speed input: 171.59 toks/s, output: 655.09 toks/s]Processed prompts:  62%|██████▏   | 131/212 [02:15<01:05,  1.23it/s, est. speed input: 171.70 toks/s, output: 656.54 toks/s]Processed prompts:  62%|██████▏   | 132/212 [02:15<00:53,  1.49it/s, est. speed input: 172.33 toks/s, output: 659.44 toks/s]Processed prompts:  63%|██████▎   | 133/212 [02:16<01:14,  1.06it/s, est. speed input: 172.87 toks/s, output: 662.03 toks/s]Processed prompts:  63%|██████▎   | 134/212 [02:19<01:40,  1.29s/it, est. speed input: 171.08 toks/s, output: 656.46 toks/s]Processed prompts:  64%|██████▎   | 135/212 [02:19<01:20,  1.04s/it, est. speed input: 171.24 toks/s, output: 658.27 toks/s]Processed prompts:  64%|██████▍   | 136/212 [02:19<01:02,  1.21it/s, est. speed input: 171.99 toks/s, output: 660.97 toks/s]Processed prompts:  65%|██████▍   | 137/212 [02:21<01:11,  1.05it/s, est. speed input: 172.15 toks/s, output: 659.31 toks/s]Processed prompts:  65%|██████▌   | 138/212 [02:22<01:12,  1.02it/s, est. speed input: 172.16 toks/s, output: 661.88 toks/s]Processed prompts:  66%|██████▌   | 139/212 [02:22<01:07,  1.08it/s, est. speed input: 171.78 toks/s, output: 663.68 toks/s]Processed prompts:  66%|██████▌   | 140/212 [02:24<01:17,  1.07s/it, est. speed input: 172.51 toks/s, output: 667.12 toks/s]Processed prompts:  67%|██████▋   | 141/212 [02:25<01:07,  1.05it/s, est. speed input: 173.16 toks/s, output: 668.39 toks/s]Processed prompts:  67%|██████▋   | 142/212 [02:25<00:52,  1.32it/s, est. speed input: 174.65 toks/s, output: 677.31 toks/s]Processed prompts:  67%|██████▋   | 143/212 [02:25<00:45,  1.53it/s, est. speed input: 175.63 toks/s, output: 681.46 toks/s]Processed prompts:  68%|██████▊   | 144/212 [02:26<00:38,  1.78it/s, est. speed input: 176.38 toks/s, output: 686.31 toks/s]Processed prompts:  68%|██████▊   | 145/212 [02:26<00:41,  1.61it/s, est. speed input: 176.56 toks/s, output: 688.08 toks/s]Processed prompts:  69%|██████▉   | 146/212 [02:27<00:36,  1.79it/s, est. speed input: 177.43 toks/s, output: 696.45 toks/s]Processed prompts:  69%|██████▉   | 147/212 [02:28<00:50,  1.29it/s, est. speed input: 176.69 toks/s, output: 695.18 toks/s]Processed prompts:  70%|███████   | 149/212 [02:30<01:01,  1.03it/s, est. speed input: 176.91 toks/s, output: 695.14 toks/s]Processed prompts:  71%|███████   | 150/212 [02:31<00:52,  1.19it/s, est. speed input: 177.79 toks/s, output: 698.16 toks/s]Processed prompts:  71%|███████   | 151/212 [02:31<00:43,  1.42it/s, est. speed input: 180.03 toks/s, output: 703.55 toks/s]Processed prompts:  72%|███████▏  | 152/212 [02:33<01:06,  1.11s/it, est. speed input: 178.84 toks/s, output: 703.06 toks/s]Processed prompts:  73%|███████▎  | 154/212 [02:36<01:07,  1.16s/it, est. speed input: 178.52 toks/s, output: 704.40 toks/s]Processed prompts:  73%|███████▎  | 155/212 [02:36<00:55,  1.02it/s, est. speed input: 179.16 toks/s, output: 707.91 toks/s]Processed prompts:  74%|███████▎  | 156/212 [02:37<00:49,  1.12it/s, est. speed input: 179.52 toks/s, output: 710.14 toks/s]Processed prompts:  75%|███████▍  | 158/212 [02:38<00:42,  1.27it/s, est. speed input: 180.96 toks/s, output: 712.51 toks/s]Processed prompts:  75%|███████▌  | 159/212 [02:38<00:33,  1.58it/s, est. speed input: 182.78 toks/s, output: 722.61 toks/s]Processed prompts:  75%|███████▌  | 160/212 [02:39<00:31,  1.68it/s, est. speed input: 184.28 toks/s, output: 731.08 toks/s]Processed prompts:  76%|███████▌  | 161/212 [02:40<00:34,  1.48it/s, est. speed input: 184.91 toks/s, output: 731.17 toks/s]Processed prompts:  76%|███████▋  | 162/212 [02:40<00:29,  1.70it/s, est. speed input: 186.01 toks/s, output: 734.63 toks/s]Processed prompts:  77%|███████▋  | 163/212 [02:40<00:23,  2.11it/s, est. speed input: 188.31 toks/s, output: 742.24 toks/s]Processed prompts:  77%|███████▋  | 164/212 [02:41<00:24,  1.98it/s, est. speed input: 189.30 toks/s, output: 746.17 toks/s]Processed prompts:  78%|███████▊  | 165/212 [02:41<00:23,  2.04it/s, est. speed input: 189.79 toks/s, output: 747.77 toks/s]Processed prompts:  78%|███████▊  | 166/212 [02:41<00:18,  2.52it/s, est. speed input: 190.31 toks/s, output: 752.28 toks/s]Processed prompts:  79%|███████▉  | 167/212 [02:42<00:17,  2.53it/s, est. speed input: 191.45 toks/s, output: 758.33 toks/s]Processed prompts:  79%|███████▉  | 168/212 [02:42<00:18,  2.34it/s, est. speed input: 191.98 toks/s, output: 760.13 toks/s]Processed prompts:  80%|███████▉  | 169/212 [02:45<00:44,  1.03s/it, est. speed input: 190.63 toks/s, output: 759.81 toks/s]Processed prompts:  80%|████████  | 170/212 [02:46<00:46,  1.10s/it, est. speed input: 191.28 toks/s, output: 759.22 toks/s]Processed prompts:  81%|████████  | 171/212 [02:47<00:46,  1.13s/it, est. speed input: 192.12 toks/s, output: 762.15 toks/s]Processed prompts:  82%|████████▏ | 173/212 [02:49<00:38,  1.02it/s, est. speed input: 192.50 toks/s, output: 765.79 toks/s]Processed prompts:  82%|████████▏ | 174/212 [02:49<00:29,  1.27it/s, est. speed input: 193.17 toks/s, output: 771.19 toks/s]Processed prompts:  83%|████████▎ | 175/212 [02:50<00:29,  1.27it/s, est. speed input: 193.96 toks/s, output: 773.41 toks/s]Processed prompts:  83%|████████▎ | 176/212 [02:50<00:22,  1.63it/s, est. speed input: 194.78 toks/s, output: 777.67 toks/s]Processed prompts:  83%|████████▎ | 177/212 [02:52<00:31,  1.11it/s, est. speed input: 196.77 toks/s, output: 776.23 toks/s]Processed prompts:  84%|████████▍ | 178/212 [02:52<00:29,  1.14it/s, est. speed input: 197.66 toks/s, output: 776.84 toks/s]Processed prompts:  84%|████████▍ | 179/212 [02:53<00:22,  1.49it/s, est. speed input: 198.42 toks/s, output: 782.60 toks/s]Processed prompts:  85%|████████▍ | 180/212 [02:53<00:17,  1.83it/s, est. speed input: 199.82 toks/s, output: 789.97 toks/s]Processed prompts:  85%|████████▌ | 181/212 [02:54<00:19,  1.59it/s, est. speed input: 200.25 toks/s, output: 792.87 toks/s]Processed prompts:  86%|████████▌ | 182/212 [02:55<00:21,  1.40it/s, est. speed input: 201.01 toks/s, output: 793.22 toks/s]Processed prompts:  87%|████████▋ | 184/212 [02:58<00:31,  1.13s/it, est. speed input: 199.34 toks/s, output: 794.21 toks/s]Processed prompts:  88%|████████▊ | 186/212 [02:58<00:19,  1.34it/s, est. speed input: 201.33 toks/s, output: 800.06 toks/s]Processed prompts:  88%|████████▊ | 187/212 [02:59<00:16,  1.51it/s, est. speed input: 201.98 toks/s, output: 805.67 toks/s]Processed prompts:  89%|████████▊ | 188/212 [03:00<00:18,  1.27it/s, est. speed input: 201.64 toks/s, output: 804.17 toks/s]Processed prompts:  89%|████████▉ | 189/212 [03:00<00:17,  1.32it/s, est. speed input: 203.33 toks/s, output: 806.70 toks/s]Processed prompts:  90%|████████▉ | 190/212 [03:01<00:14,  1.57it/s, est. speed input: 203.99 toks/s, output: 809.19 toks/s]Processed prompts:  90%|█████████ | 191/212 [03:01<00:13,  1.56it/s, est. speed input: 204.85 toks/s, output: 813.49 toks/s]Processed prompts:  91%|█████████ | 193/212 [03:02<00:10,  1.89it/s, est. speed input: 206.24 toks/s, output: 822.82 toks/s]Processed prompts:  92%|█████████▏| 194/212 [03:02<00:07,  2.30it/s, est. speed input: 209.23 toks/s, output: 826.83 toks/s]Processed prompts:  92%|█████████▏| 195/212 [03:03<00:08,  2.08it/s, est. speed input: 209.44 toks/s, output: 828.15 toks/s]Processed prompts:  92%|█████████▏| 196/212 [03:03<00:07,  2.22it/s, est. speed input: 209.89 toks/s, output: 833.65 toks/s]Processed prompts:  93%|█████████▎| 197/212 [03:04<00:06,  2.29it/s, est. speed input: 210.56 toks/s, output: 840.28 toks/s]Processed prompts:  93%|█████████▎| 198/212 [03:04<00:07,  2.00it/s, est. speed input: 212.13 toks/s, output: 846.03 toks/s]Processed prompts:  94%|█████████▍| 199/212 [03:05<00:06,  2.05it/s, est. speed input: 212.77 toks/s, output: 848.32 toks/s]Processed prompts:  94%|█████████▍| 200/212 [03:06<00:09,  1.23it/s, est. speed input: 211.92 toks/s, output: 845.54 toks/s]Processed prompts:  95%|█████████▍| 201/212 [03:11<00:21,  1.92s/it, est. speed input: 207.73 toks/s, output: 832.11 toks/s]Processed prompts:  95%|█████████▌| 202/212 [03:12<00:17,  1.75s/it, est. speed input: 207.48 toks/s, output: 831.75 toks/s]Processed prompts:  96%|█████████▌| 203/212 [03:14<00:15,  1.78s/it, est. speed input: 206.48 toks/s, output: 829.38 toks/s]Processed prompts:  96%|█████████▌| 204/212 [03:17<00:16,  2.10s/it, est. speed input: 204.30 toks/s, output: 823.22 toks/s]Processed prompts:  97%|█████████▋| 205/212 [03:20<00:17,  2.50s/it, est. speed input: 202.40 toks/s, output: 816.37 toks/s]Processed prompts:  97%|█████████▋| 206/212 [03:21<00:11,  1.96s/it, est. speed input: 203.34 toks/s, output: 819.85 toks/s]Processed prompts:  98%|█████████▊| 207/212 [03:22<00:08,  1.60s/it, est. speed input: 203.46 toks/s, output: 826.00 toks/s]Processed prompts:  98%|█████████▊| 208/212 [03:22<00:04,  1.21s/it, est. speed input: 204.00 toks/s, output: 832.10 toks/s]Processed prompts:  99%|█████████▊| 209/212 [03:22<00:02,  1.12it/s, est. speed input: 205.63 toks/s, output: 839.78 toks/s]Processed prompts:  99%|█████████▉| 210/212 [03:23<00:01,  1.43it/s, est. speed input: 206.53 toks/s, output: 845.16 toks/s]Processed prompts: 100%|█████████▉| 211/212 [03:25<00:01,  1.35s/it, est. speed input: 204.56 toks/s, output: 840.46 toks/s]Processed prompts: 100%|██████████| 212/212 [03:41<00:00,  5.47s/it, est. speed input: 191.12 toks/s, output: 791.83 toks/s]Processed prompts: 100%|██████████| 212/212 [03:41<00:00,  1.04s/it, est. speed input: 191.12 toks/s, output: 791.83 toks/s]
Results for dataset statistics_dataset_textonly saved to project/Kaiyue/offline_outputs/CohereForAI_c4ai-command-r-v01/statistics_dataset_textonly/response.jsonl.
Releasing GPU memory...
GPU memory released successfully.
Releasing GPU memory...
GPU memory released successfully.
[rank0]:[W128 01:25:17.656037204 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
/gpfs/radev/home/lx228/miniconda3/envs/kaiyue/lib/python3.12/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 1 leaked shared_memory objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
